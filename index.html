<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –æ—Ç –®–ê–ì–ê–ô –î–û–ú–ê‚ö°</title>
<meta name="description" content="–£–∑–Ω–∞–π—Ç–µ, –∑–∞ —Å–∫–æ–ª—å–∫–æ –Ω–µ–¥–µ–ª—å —à–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø–æ–º–æ–≥—É—Ç –≤–∞–º –ø–æ—Ö—É–¥–µ—Ç—å."/>
<meta name="color-scheme" content="light only"/>
<link rel="preload" as="video" href="intro.mp4" type="video/mp4" fetchpriority="high">
<link rel="preload" as="image" href="superfit.png">
<link rel="preload" as="image" href="m.png">
<link rel="preload" as="image" href="xxl.png">
<style>
:root{--r:#CF2C02;--y:#FFBA08;--o:#E85D04;--g:#D9D9D9;--txt:#1a1a1a;--hero-pos-y:28%;--hero-pos-y-m:22%}
*{box-sizing:border-box} html,body{height:100%}
body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial;color:var(--txt);background:#fff;overflow-x:hidden}
.app{width:min(960px,100%);margin:0 auto;padding:16px}
.card{background:#fff;border-radius:22px;box-shadow:0 10px 30px rgba(0,0,0,.08);padding:16px;overflow:hidden;position:relative}

/* HERO */
.hero-wrap{position:relative;margin:0 0 12px;border-radius:20px;overflow:hidden;box-shadow:0 10px 18px rgba(0,0,0,.08)}
.hero-media{display:block;width:100%;height:auto;aspect-ratio:16/9;object-fit:cover;object-position:50% var(--hero-pos-y);border-radius:20px}
@media (max-width:480px){.hero-media{object-position:50% var(--hero-pos-y-m)}}
.hero-skel{position:absolute;inset:0;border-radius:20px;background:linear-gradient(110deg,#f4f4f4 8%,#eaeaea 18%,#f4f4f4 33%);background-size:200% 100%;animation:heroShimmer 1.2s linear infinite}
@keyframes heroShimmer{to{background-position-x:-200%}}
.hero-skel.hide{opacity:0;pointer-events:none;transition:opacity .25s ease}

/* Screens */
.screen{display:none;animation:.35s fs ease both;padding-bottom:90px}
.screen.is{display:block}
@keyframes fs{from{opacity:0;transform:translateY(12px)}to{opacity:1;transform:translateY(0)}}
h1{font-size:clamp(22px,5.6vw,38px);line-height:1.15;margin:8px 0 10px}
h2{font-size:clamp(20px,5vw,30px);line-height:1.18;margin:6px 0 12px}
.hint{color:#6b6b6b;font-size:.95rem}
.grid{display:grid;gap:10px}.cols2{grid-template-columns:1fr 1fr}
@media (max-width:620px){.cols2{grid-template-columns:1fr}}

.opt{border:2px solid var(--g);border-radius:14px;padding:12px;display:flex;gap:10px;align-items:center;background:#fff;cursor:pointer;transition:.2s}
.opt.is{border-color:var(--o);box-shadow:0 6px 16px rgba(232,93,4,.12)}
.opt--img{flex-direction:column;align-items:center;text-align:center;padding:10px}
.opt--img img{width:100%;height:180px;object-fit:contain;background:#fafafa;border-radius:12px}
.opt--img span{margin-top:8px;font-weight:600}

.chips{display:flex;flex-wrap:wrap;gap:8px}.chip{border:2px solid var(--g);border-radius:999px;padding:8px 12px;background:#fff;cursor:pointer}
.chip.is{border-color:var(--o);box-shadow:0 6px 16px rgba(232,93,4,.12)}
.text{width:100%;border:2px solid var(--g);border-radius:12px;padding:10px 12px;font-size:1rem}

.actions{display:flex;gap:8px;margin-top:14px}
.btn{border:none;border-radius:12px;padding:12px 16px;font-weight:700;cursor:pointer}
.primary{background:linear-gradient(135deg,var(--r),var(--o));color:#fff;box-shadow:0 10px 18px rgba(207,44,2,.25)}
.ghost{background:#fff;border:2px solid var(--g)}
.sticky{position:sticky;bottom:0;background:linear-gradient(0deg,#fff 70%,rgba(255,255,255,0));padding-top:8px;z-index:20}

/* Progress circle + logo */
#progress{position:relative;height:auto;margin:0 0 12px;display:flex;align-items:center;gap:10px}
#progress.hide{display:none!important}
#progress .pcirc{--p:0%;width:56px;height:56px;border-radius:50%;background:conic-gradient(var(--o) var(--p),#eee 0);position:relative;display:inline-grid;place-items:center;box-shadow:0 6px 16px rgba(0,0,0,.08);transition:background .15s linear;flex:0 0 56px}
#progress .pcirc::after{content:"";width:44px;height:44px;border-radius:50%;background:#fff;position:absolute}
#progress .pct{position:relative;z-index:1;font-size:.9rem;font-weight:800;letter-spacing:-.02em}
#progress .plogo{margin-left:auto;display:flex;align-items:center;flex:0 0 auto}
#progress .plogo img{height:32px;width:auto;display:block;object-fit:contain}
@media (max-width:480px){#progress .plogo img{height:28px}}

/* Steps slider */
#steps{--pct:0%;--track:#e9e9e9;--fill-start:var(--r);--fill-end:var(--o);width:100%;height:40px;background:transparent;accent-color:var(--o)}
#steps:focus{outline:none}
#steps::-webkit-slider-runnable-track{height:12px;border-radius:999px;background:linear-gradient(90deg,var(--fill-start) 0 var(--pct),var(--track) var(--pct) 100%);box-shadow:inset 0 1px 2px rgba(0,0,0,.08)}
#steps::-webkit-slider-thumb{-webkit-appearance:none;width:28px;height:28px;border-radius:50%;background:#fff;border:3px solid var(--o);box-shadow:0 4px 10px rgba(232,93,4,.25);margin-top:-8px;transition:transform .12s ease}
#steps:active::-webkit-slider-thumb{transform:scale(1.06)}
#steps::-moz-range-track{height:12px;border-radius:999px;background:#e9e9e9}
#steps::-moz-range-progress{height:12px;border-radius:999px;background:linear-gradient(135deg,var(--fill-start),var(--fill-end))}
#steps::-moz-range-thumb{width:28px;height:28px;border-radius:50%;background:#fff;border:3px solid var(--o);box-shadow:0 4px 10px rgba(232,93,4,.25)}

/* BMI */
.bmi-line{margin-top:6px}
.bmi-tag{display:inline-block;padding:4px 8px;border-radius:999px;font-weight:700;font-size:.9rem;vertical-align:baseline}
.bmi-ok{background:#e8f7ee;color:#0f7a42}.bmi-warn{background:#fff4e6;color:#a04b00}.bmi-bad{background:#ffe8e6;color:#a11000}

/* Habits */
.habit{display:grid;gap:14px}
.habit-grid{display:grid;gap:12px;grid-template-columns:1fr 1fr}
@media (max-width:720px){.habit-grid{grid-template-columns:1fr}}
.habit h3{margin:.2rem 0 .6rem;font-size:1.02rem}
.habit .col{border:2px solid var(--g);border-radius:14px;padding:12px;background:#fff}
.chips--pills{gap:10px}
.chips--pills .chip{border-radius:999px;padding:10px 14px;font-weight:600;border:2px solid var(--g);background:#fff;position:relative;transition:transform .08s ease,border-color .15s ease,box-shadow .15s ease,background .2s ease,color .2s ease}
.chips--pills .chip[data-kind="bad"]{border-color:#ffd7cf}
.chips--pills .chip[data-kind="good"]{border-color:#cfeede}
.chips--pills .chip.is{transform:translateY(-1px) scale(1.02);color:#111}
.chips--pills .chip[data-kind="bad"].is{background:linear-gradient(135deg,#ffe9e3,#ffd3c9);border-color:#ffb5a5;box-shadow:0 6px 16px rgba(255,115,97,.18)}
.chips--pills .chip[data-kind="good"].is{background:linear-gradient(135deg,#e9f9f0,#d5f1e6);border-color:#bfe7d6;box-shadow:0 6px 16px rgba(21,178,116,.16)}
.chips--pills .chip.is::after{content:"‚úì";position:absolute;top:-8px;right:-8px;width:22px;height:22px;border-radius:50%;display:grid;place-items:center;font-weight:800;font-size:.85rem;background:#fff;border:2px solid #ddd;box-shadow:0 2px 8px rgba(0,0,0,.1)}

.habit-meter{border:2px solid var(--g);border-radius:14px;padding:12px;background:#fff}
.hm-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
#hmScore{font-weight:800}
.hm-track{--p:50%;position:relative;height:14px;border-radius:999px;overflow:hidden;background:linear-gradient(90deg,#ffe1db 0%,#fff7e8 50%,#e7f7ef 100%);box-shadow:inset 0 1px 2px rgba(0,0,0,.08)}
.hm-pointer{position:absolute;top:50%;left:var(--p);transform:translate(-50%,-50%);width:18px;height:18px;border-radius:50%;background:#fff;border:3px solid var(--o);box-shadow:0 4px 12px rgba(0,0,0,.12);transition:left .25s ease,border-color .2s ease}
.hm-scale{display:flex;justify-content:space-between;font-size:.82rem;color:#666;margin-top:6px}
.hm-badge{display:inline-block;padding:4px 8px;border-radius:999px;font-weight:700;font-size:.85rem;margin-left:8px}
.hm-bad{background:#ffe9e6;color:#a11000}.hm-ok{background:#fff3cc;color:#9a6b00}.hm-good{background:#e7f7ef;color:#0f7a42}

/* Hard cards */
.hardw{display:grid;gap:14px}
.hard-cards{display:grid;gap:12px;grid-template-columns:1fr 1fr}
@media (max-width:760px){.hard-cards{grid-template-columns:1fr}}
.hcard{position:relative;border:2px solid var(--g);border-radius:16px;background:#fff;padding:14px;cursor:pointer;transform-style:preserve-3d;transition:transform .15s ease,box-shadow .2s ease,border-color .2s;box-shadow:0 8px 18px rgba(0,0,0,.05);overflow:hidden}
.hcard:hover{box-shadow:0 12px 26px rgba(0,0,0,.08)}
.hcard.is{border-color:var(--o);background:linear-gradient(180deg,#fff 0,#fff9f3 100%);box-shadow:0 12px 26px rgba(232,93,4,.18)}
.hhead{display:flex;gap:10px;align-items:center;font-weight:800;letter-spacing:-.02em}
.hicon{width:44px;height:44px;border-radius:12px;display:grid;place-items:center;font-size:22px;background:#fff6f1;border:2px solid #ffd5c2}

/* Goal UI */
.goalw{display:grid;gap:12px}
.goal-top{display:grid;gap:8px;grid-template-columns:1.05fr .95fr}
@media (max-width:780px){.goal-top{grid-template-columns:1fr}}
.goal-card{border:2px solid var(--g);border-radius:16px;padding:10px;background:#fff;overflow:hidden}
.goal-fig{position:relative;height:260px;border:2px solid var(--g);border-radius:16px;padding:8px;background:#fff;overflow:hidden}
@media (max-width:480px){.goal-fig{height:220px}}
.goal-range .val{display:flex;align-items:baseline;gap:8px;font-size:clamp(18px,4.6vw,28px);font-weight:800;letter-spacing:-.03em;white-space:nowrap}
.goal-range .sub{color:#666;margin-top:2px}
#goalRange{width:100%;height:38px;background:transparent;accent-color:var(--o);--track:#e9e9e9;--fill-start:var(--r);--fill-end:var(--o)}
#goalRange:focus{outline:none}
#goalRange::-webkit-slider-runnable-track{height:12px;border-radius:999px;background:linear-gradient(90deg,var(--fill-start) 0 var(--pct),var(--track) var(--pct) 100%);box-shadow:inset 0 1px 2px rgba(0,0,0,.08)}
#goalRange::-webkit-slider-thumb{-webkit-appearance:none;width:26px;height:26px;border-radius:50%;background:#fff;border:3px solid var(--o);box-shadow:0 4px 12px rgba(232,93,4,.25);margin-top:-7px;transition:transform .12s ease}
#goalRange:active::-webkit-slider-thumb{transform:scale(1.06)}
#goalRange::-moz-range-track{height:12px;border-radius:999px;background:#e9e9e9}
#goalRange::-moz-range-progress{height:12px;border-radius:999px;background:linear-gradient(135deg,var(--fill-start),var(--fill-end))}
#goalRange::-moz-range-thumb{width:26px;height:26px;border-radius:50%;background:#fff;border:3px solid var(--o);box-shadow:0 4px 12px rgba(232,93,4,.25)}
.goal-switch{display:flex;align-items:center;gap:10px;padding:8px 12px;border:2px solid var(--g);border-radius:12px;background:#fff;cursor:pointer;user-select:none;width:max-content}
.goal-switch input{appearance:none;width:42px;height:24px;border-radius:999px;background:#e9e9e9;position:relative;outline:none;transition:.2s}
.goal-switch input::after{content:"";position:absolute;top:3px;left:3px;width:18px;height:18px;border-radius:50%;background:#fff;box-shadow:0 1px 4px rgba(0,0,0,.15);transition:.2s}
.goal-switch input:checked{background:linear-gradient(135deg,var(--r),var(--o))}
.goal-switch input:checked::after{left:21px}
.goal-badge{display:inline-block;padding:6px 10px;border-radius:999px;font-weight:800;font-size:.92rem}
.goal-soft{background:#e9f2ff;color:#084c9e}.goal-mid{background:#fff3cc;color:#9a6b00}.goal-hard{background:#ffe9e6;color:#a11000}

/* Goal silhouettes stack */
.goal-stack{position:relative;width:100%;height:100%}
.goal-stack img{position:absolute;inset:0;width:100%;height:100%;object-fit:contain;opacity:0;transform:scale(1);transition:opacity .28s ease,transform .28s ease;filter:drop-shadow(0 8px 22px rgba(0,0,0,.08))}
.goal-stack .tape{display:none!important} /* –ª–µ–Ω—Ç—É —Å–∫—Ä—ã–ª–∏ */

/* Loading/result/sale */
.loader2{display:flex;flex-direction:column;align-items:center;text-align:center;padding:28px 8px 12px}
.loader2 .ring{--p:0%;width:88px;height:88px;border-radius:50%;background:conic-gradient(var(--o) var(--p),#eee 0);position:relative;box-shadow:0 8px 20px rgba(0,0,0,.08)}
.loader2 .ring::after{content:"";position:absolute;inset:10px;background:#fff;border-radius:50%}
.loader2 .pct{position:absolute;inset:0;display:grid;place-items:center;font-weight:800}
.loader2 .lmsg{margin-top:14px;font-weight:700;font-size:1.05rem}
.counter{font-size:clamp(26px,6vw,48px);line-height:1.15;letter-spacing:-.02em;text-wrap:balance}
.sale-hero{margin:0 0 12px;border-radius:16px;overflow:hidden}
.sale-hero img{width:100%;display:block;border-radius:16px;object-fit:cover}
/* –¢–æ–Ω—å—à–µ —Ç–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞ –≤ –≤–æ–ø—Ä–æ—Å–µ "–ß—Ç–æ —Å–µ–π—á–∞—Å –¥–∞—ë—Ç—Å—è —Ç—è–∂–µ–ª–µ–µ –≤—Å–µ–≥–æ?" */
.hhead,
.hhead *{
  font-weight: 500 !important; /* –±—ã–ª–æ 800 */
}
</style>
</head>
<body>
  <div class="app"><div class="card">
    <div id="progress"></div>
    <div id="screens"></div>
  </div></div>

<script>
const $=s=>document.querySelector(s),$$=(s,r=document)=>Array.from((r||document).querySelectorAll(s));
const vibrate=n=>{try{navigator.vibrate&&navigator.vibrate(n||12)}catch(e){}};
const A=JSON.parse(localStorage.getItem('sdq')||'{}'); const save=()=>localStorage.setItem('sdq',JSON.stringify(A));

/* dicts */
const AGE=['18‚Äì29','30‚Äì39','40‚Äì49','50+'];
const BODY=[{label:'–•—É–¥–æ—â–∞–≤–æ–µ',key:'slim',img:'skinny.png',alt:'–•—É–¥–æ—â–∞–≤–æ–µ —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ'},{label:'–°—Ä–µ–¥–Ω–µ–µ',key:'avg',img:'slim.png',alt:'–°—Ä–µ–¥–Ω–µ–µ —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ'},{label:'–ö—Ä—É–ø–Ω–æ–µ',key:'large',img:'medium.png',alt:'–ö—Ä—É–ø–Ω–æ–µ —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ'},{label:'–ò–∑–±—ã—Ç–æ—á–Ω—ã–π –≤–µ—Å',key:'obese',img:'xl.png',alt:'–ò–∑–±—ã—Ç–æ—á–Ω—ã–π –≤–µ—Å'}];
const LIFE=['–°–∏–¥—è—á–∞—è —Ä–∞–±–æ—Ç–∞','–£–º–µ—Ä–µ–Ω–Ω–æ –∞–∫—Ç–∏–≤–Ω–∞—è','–ê–∫—Ç–∏–≤–Ω–∞—è'];
const EXP=['–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∑–∞–Ω–∏–º–∞–ª–∞—Å—å','–ò–Ω–æ–≥–¥–∞ –¥–æ–º–∞ / –ø–æ –≤–∏–¥–µ–æ','–†–µ–≥—É–ª—è—Ä–Ω–æ'];
const MOT=['–î–ª—è –∑–¥–æ—Ä–æ–≤—å—è','–î–ª—è –≤–Ω–µ—à–Ω–æ—Å—Ç–∏','–î–ª—è —ç–Ω–µ—Ä–≥–∏–∏ –∏ –ª—ë–≥–∫–æ—Å—Ç–∏','–î–ª—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ —Å–µ–±–µ'];
const HEALTH=['–î–∏–∞–±–µ—Ç','–ü—Ä–æ–±–ª–µ–º—ã —Å–æ —â–∏—Ç–æ–≤–∏–¥–∫–æ–π','–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è','–ë–æ–ª—å –≤ —Å—É—Å—Ç–∞–≤–∞—Ö','–ë–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å','–ù–µ—Ç'];
const BAD=['–°–ª–∞–¥–∫–∞—è –≥–∞–∑–∏—Ä–æ–≤–∫–∞','–í—ã–ø–µ—á–∫–∞','–§–∞—Å—Ç—Ñ—É–¥','–ö–æ–ª–±–∞—Å–∞/—Å–æ—Å–∏—Å–∫–∏','–°—ã—Ä 45%+','–ù–æ—á–Ω—ã–µ –ø–µ—Ä–µ–∫—É—Å—ã','–ê–ª–∫–æ–≥–æ–ª—å —á–∞—â–µ 2 —Ä/–Ω–µ–¥','–°–ª–∞–¥–∫–∏–π —á–∞–π/–∫–æ—Ñ–µ','–û—á–µ–Ω—å —Å–æ–ª—ë–Ω–∞—è –ø–∏—â–∞'];
const GOOD=['1.5‚Äì2 –ª –≤–æ–¥—ã','–û–≤–æ—â–∏ 400 –≥/–¥–µ–Ω—å','–§—Ä—É–∫—Ç—ã –µ–∂–µ–¥–Ω–µ–≤–Ω–æ','–ë–µ–ª–æ–∫ –≤ –∫–∞–∂–¥–æ–º –ø—Ä–∏—ë–º–µ –ø–∏—â–∏','10‚Äì20 –º–∏–Ω —Ä–∞—Å—Ç—è–∂–∫–∏','8 000+ —à–∞–≥–æ–≤ —É–∂–µ —Å–µ–π—á–∞—Å'];

/* scaffolding */
const screensRoot=$('#screens');
const section=(id,html)=>`<section class="screen${id==='intro'?' is':''}" data-id="${id}">${html}</section>`;
const chips=(id,arr)=>`<div class="chips" id="${id}">`+arr.map(t=>`<button type="button" class="chip" data-v="${t}">${t}</button>`).join('')+`</div>`;
const opts=(id,arr)=>`<div class="grid cols2" id="${id}">`+arr.map(t=>{let label,key;if(typeof t==='string'){label=t;key=t}else if(Array.isArray(t)){label=t[0];key=t[1]??t[0]}else if(t&&typeof t==='object'){label=t.label??t.value??t.key??'';key=t.key??t.value??t.label??''}else{label=String(t);key=String(t)}return `<label class="opt" data-v="${String(key)}"><span>${String(label)}</span></label>`}).join('')+`</div>`;
const actions=()=>`<div class="actions sticky"><button class="btn ghost" data-prev>–ù–∞–∑–∞–¥</button><button class="btn primary" data-next>–î–∞–ª–µ–µ</button></div>`;

/* screens */
const html=
section('intro',`
  <figure class="hero-wrap">
    <div class="hero-skel" id="heroSkel"></div>
    <video class="hero-media" autoplay muted loop playsinline preload="auto">
      <source src="intro.mp4#t=0.1" type="video/mp4"/>
      <img src="logo.png" alt="–®–ê–ì–ê–ô –î–û–ú–ê"/>
    </video>
  </figure>
  <h1>–£–∑–Ω–∞–π—Ç–µ, –∑–∞ —Å–∫–æ–ª—å–∫–æ –Ω–µ–¥–µ–ª—å —à–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –ø–æ–º–æ–≥—É—Ç –≤–∞–º –ø–æ—Ö—É–¥–µ—Ç—å</h1>
  <p class="hint">–û—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å–æ–≤ ‚Äî —ç—Ç–æ –∑–∞–π–º—ë—Ç 1‚Äì2 –º–∏–Ω—É—Ç—ã.</p>
  <div class="grid"><div><div class="hint">–ö–∞–∫ –∫ –≤–∞–º –æ–±—Ä–∞—â–∞—Ç—å—Å—è?</div><input id="name" class="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ò—Ä–∏–Ω–∞"></div></div>
  <div class="actions sticky"><button class="btn primary" data-next>–ü–æ–µ—Ö–∞–ª–∏ ‚Üí</button></div>
`)
+section('age',`<h2>–í–∞—à –≤–æ–∑—Ä–∞—Å—Ç</h2>${opts('ageOpts',AGE)}${actions()}`)
+section('body',`
  <h2>–¢–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ —Å–µ–π—á–∞—Å</h2>
  <div class="grid cols2" id="bodyOpts">
    ${BODY.map(o=>`<label class="opt opt--img" data-v="${o.key}"><img src="${o.img}" alt="${o.alt}"><span>${o.label}</span></label>`).join('')}
  </div>${actions()}
`)
+section('steps',`
  <h2>–°–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤ –≤—ã –ø—Ä–æ—Ö–æ–¥–∏—Ç–µ —Å–µ–π—á–∞—Å –≤ –¥–µ–Ω—å (–ø—Ä–∏–º–µ—Ä–Ω–æ)?</h2>
  <input id="steps" type="range" min="0" max="25000" step="250" value="4000">
  <div class="hint">–°–µ–π—á–∞—Å: <b><span id="sv">4000</span> —à–∞–≥–æ–≤</b></div>
  <p class="hint"><b>–ü–æ–¥—Å–∫–∞–∑–∫–∞:</b> –Ω–∞–π—Ç–∏ —à–∞–≥–∏ –º–æ–∂–Ω–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –≤–∞—à–µ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞/–±—Ä–∞—Å–ª–µ—Ç–∞</p>
  ${actions()}
`)
+section('bmi',`
  <h2>–î–∞–≤–∞–π—Ç–µ –ø–æ—Å—á–∏—Ç–∞–µ–º –≤–∞—à –ò–ú–¢</h2>
  <p class="hint">–£–∫–∞–∂–∏—Ç–µ –≤–∞—à —Ä–æ—Å—Ç –∏ –≤–µ—Å ‚Äî –º–æ–∂–Ω–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ.</p>
  <div class="grid cols2">
    <div><div class="hint">–†–æ—Å—Ç, —Å–º</div><input id="h" type="number" class="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 165"></div>
    <div><div class="hint">–í–µ—Å, –∫–≥</div><input id="w" type="number" class="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: 72"></div>
  </div>
  <div id="bmiI" class="hint"></div>
  ${actions()}
`)
+section('life',`<h2>–û–±—Ä–∞–∑ –∂–∏–∑–Ω–∏</h2>${opts('lifeOpts',LIFE)}${actions()}`)
+section('exp',`<h2>–û–ø—ã—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h2>${opts('expOpts',EXP)}${actions()}`)
+section('goal',`
  <h2>–í–∞—à–∞ —Ü–µ–ª—å</h2>
  <div class="goalw">
    <div class="goal-top">
      <div class="goal-card">
        <div class="goal-range">
          <div class="val"><span class="minus">‚àí</span><span id="goalVal">5.0</span> –∫–≥</div>
          <div class="sub"><span id="goalBadge" class="goal-badge goal-mid">—É–º–µ—Ä–µ–Ω–Ω–æ</span></div>
        </div>
        <input id="goalRange" type="range" min="0" max="20" step="0.5" value="5">
        <div class="hint">–ü–æ—Ç—è–Ω–∏—Ç–µ –ø–æ–ª–∑—É–Ω–æ–∫: 0 ‚Äî –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ñ–æ—Ä–º—É ¬∑ 20 ‚Äî –∞–º–±–∏—Ü–∏–æ–∑–Ω–∞—è —Ü–µ–ª—å</div>
        <label class="goal-switch" style="margin-top:10px"><input id="goalKeep" type="checkbox"><span>–ù–∞–∫–∞—á–∞—Ç—å –º—ã—à—Ü—ã </span></label>
      </div>
      <div class="goal-fig">
        <div class="goal-stack" id="goalStack">
          <!-- –ø–æ—Ä—è–¥–æ–∫: –æ—Ç —Å–∞–º–æ–≥–æ —Å—Ç—Ä–æ–π–Ω–æ–≥–æ –∫ —Å–∞–º–æ–º—É –æ–±—ä—ë–º–Ω–æ–º—É -->
          <img src="superfit.png" data-i="0" alt="superfit" loading="lazy" decoding="async">
          <img src="fit.png"      data-i="1" alt="fit"      loading="lazy" decoding="async">
          <img src="skinny.png"   data-i="2" alt="skinny"   loading="lazy" decoding="async">
          <img src="slim.png"     data-i="3" alt="slim"     loading="lazy" decoding="async">
          <img src="s.png"        data-i="4" alt="s"        loading="lazy" decoding="async">
          <img src="m.png"        data-i="5" alt="m"        loading="lazy" decoding="async">
          <img src="l.png"        data-i="6" alt="l"        loading="lazy" decoding="async">
          <img src="xl.png"       data-i="7" alt="xl"       loading="lazy" decoding="async">
          <img src="xxl.png"      data-i="8" alt="xxl"      loading="lazy" decoding="async">
          <div class="tape" id="goalTape"></div>
        </div>
      </div>
    </div>
    <p class="goal-note">–¶–µ–ª—å –º–æ–∂–Ω–æ —É—Ç–æ—á–Ω–∏—Ç—å –ø–æ–∑–∂–µ ‚Äî —Ä–∞—Å—á—ë—Ç –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –ø–æ–¥ –≤–∞—à —Ç–µ–º–ø –∏ —Å–∞–º–æ—á—É–≤—Å—Ç–≤–∏–µ.</p>
    ${actions()}
  </div>
`)
+section('motivation',`<h2>–ü–æ—á–µ–º—É –≤—ã —Ö–æ—Ç–∏—Ç–µ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Å–ø–æ—Ä—Ç–æ–º?</h2>${chips('motChips',MOT)}${actions()}`)
+section('perweek',`<h2>–°–∫–æ–ª—å–∫–æ –≥–æ—Ç–æ–≤—ã —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –Ω–µ–¥–µ–ª—é?</h2>${chips('pwChips',['2 —Ä–∞–∑–∞','3 —Ä–∞–∑–∞','4‚Äì5 —Ä–∞–∑','–ö–∞–∂–¥—ã–π –¥–µ–Ω—å 20‚Äì30 –º–∏–Ω'])}${actions()}`)
+section('hard',`
  <h2>–ß—Ç–æ —Å–µ–π—á–∞—Å –¥–∞—ë—Ç—Å—è —Ç—è–∂–µ–ª–µ–µ –≤—Å–µ–≥–æ?</h2>
  <div class="hardw">
    <div class="hard-cards" id="hardCards">
      <div class="hcard" data-k="walk"><div class="hhead"><div class="hicon">üö∂‚Äç‚ôÄÔ∏è</div><div>–î–æ–ª–≥–∞—è –ø—Ä–æ–≥—É–ª–∫–∞ —É—Ç–æ–º–ª—è–µ—Ç</div></div></div>
      <div class="hcard" data-k="stairs"><div class="hhead"><div class="hicon">ü™ú</div><div>–ö–∞–∂–¥—ã–π –ø—Ä–æ–ª—ë—Ç –ø–æ –ª–µ—Å—Ç–Ω–∏—Ü–µ ‚Äî –∏—Å–ø—ã—Ç–∞–Ω–∏–µ</div></div></div>
      <div class="hcard" data-k="games"><div class="hhead"><div class="hicon">üéØ</div><div>–°—Ç—ã–¥–Ω–æ –≤–∫–ª—é—á–∞—Ç—å—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ –∏–≥—Ä—ã</div></div></div>
      <div class="hcard" data-k="jumps"><div class="hhead"><div class="hicon">ü¶ò</div><div>–ü—Ä—ã–∂–∫–∏</div></div></div>
      <div class="hcard" data-k="none"><div class="hhead"><div class="hicon">‚úÖ</div><div>–ù–∏—á–µ–≥–æ –∏–∑ —ç—Ç–æ–≥–æ</div></div></div>
    </div>
    ${actions()}
  </div>
`)
+section('health',`<h2>–ï—Å—Ç—å –ª–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–∂–Ω–æ —É—á–∏—Ç—ã–≤–∞—Ç—å?</h2>${chips('healthChips',HEALTH)}<p class="hint">–ï—Å–ª–∏ –µ—Å—Ç—å —Å–æ–º–Ω–µ–Ω–∏—è ‚Äî –ø—Ä–æ–∫–æ–Ω—Å—É–ª—å—Ç–∏—Ä—É–π—Ç–µ—Å—å —Å –≤—Ä–∞—á–æ–º.</p>${actions()}`)
+section('nutrition',`<h2>–ü–∏—Ç–∞–Ω–∏–µ</h2>${opts('nutriOpts',[{label:'–ë—É–¥—É –ø–∏—Ç–∞—Ç—å—Å—è –ø–æ –º–µ–Ω—é-–∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—É –≤ –∫–ª—É–±–µ',key:'menu'},{label:'–•–æ—á—É –Ω–∞—É—á–∏—Ç—å—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ—Å—Ç–∞–≤–ª—è—Ç—å —Ç–∞—Ä–µ–ª–∫—É',key:'plate'},{label:'–ù–µ—Ç, –ø–æ–∫–∞ –±–µ–∑ –ø–∏—Ç–∞–Ω–∏—è',key:'no'}])}${actions()}`)
+section('food',`
  <h2>–ü—Ä–∏–≤—ã—á–∫–∏ –∏ –ø—Ä–æ–¥—É–∫—Ç—ã</h2>
  <div class="habit">
    <div class="habit-grid">
      <div class="col"><h3>–¢–æ—Ä–º–æ–∑–∏—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å</h3><div class="chips chips--pills" id="bad">${BAD.map(x=>`<button type="button" class="chip" data-kind="bad" data-v="${x}">${x}</button>`).join('')}</div></div>
      <div class="col"><h3>–£—Å–∫–æ—Ä—è–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç</h3><div class="chips chips--pills" id="good">${GOOD.map(x=>`<button type="button" class="chip" data-kind="good" data-v="${x}">${x}</button>`).join('')}</div></div>
    </div>
    <div class="habit-meter">
      <div class="hm-top"><div><span id="hmLabel">–ò–Ω–¥–µ–∫—Å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</span><span class="hm-badge hm-ok" id="hmBadge">–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ</span></div><span id="hmScore">0%</span></div>
      <div class="hm-track" id="hmTrack"><div class="hm-pointer" id="hmPtr"></div></div>
      <div class="hm-scale"><span>—Ç–æ—Ä–º–æ–∑–∏—Ç</span><span>–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ</span><span>—É—Å–∫–æ—Ä—è–µ—Ç</span></div>
    </div>
    <p class="hint">–û—Ç–º–µ—á–∞–π—Ç–µ —Ç–æ, —á—Ç–æ –ø—Ä–æ –≤–∞—Å ‚Äî –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ ‚ú®</p>
    <div class="actions sticky"><button class="btn ghost" data-prev>–ù–∞–∑–∞–¥</button><button class="btn primary" id="calc">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç ‚Üí</button></div>
  </div>
`)
+section('loading',`
  <div class="loader2"><div class="ring" id="lring"><div class="pct" id="lpct">0%</div></div>
  <div class="lmsg" id="lmsg">–°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ‚Ä¶</div><p class="hint" id="lsub">–í–æ–∑—Ä–∞—Å—Ç ‚Ä¢ –ò–ú–¢ ‚Ä¢ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Ä¢ –¶–µ–ª—å</p></div>
`)
+section('result',`
  <h2 id="rTitle">–ì–æ—Ç–æ–≤–æ!</h2>
  <div class="counter" id="nums">0 –∫–≥ –∑–∞ 0 –Ω–µ–¥–µ–ª—å</div>
  <p class="hint" id="rSub"></p>
  <p class="hint" id="rDisc">–ü—Ä–æ–≥–Ω–æ–∑ –Ω–æ—Å–∏—Ç –æ–∑–Ω–∞–∫–æ–º–∏—Ç–µ–ª—å–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä –∏ –Ω–µ —è–≤–ª—è–µ—Ç—Å—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π.</p>
  <div class="actions sticky"><button class="btn ghost" data-prev>–ù–∞–∑–∞–¥</button><button class="btn primary" id="toCTA">–•–æ—á—É —Ç–∞–∫–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç!</button></div>
`)
+section('sale',`
  <figure class="sale-hero"><img src="final.PNG" alt="–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —É—á–∞—Å—Ç–Ω–∏—Ü –∏ –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∫–ª—É–±–∞ ¬´–®–ê–ì–ê–ô –î–û–ú–ê¬ª"></figure>
  <h2 id="sTitle">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –∫–ª—É–±—É ¬´–®–ê–ì–ê–ô –î–û–ú–ê¬ª ‚ö°</h2>
  <p class="hint" id="sLead"></p>
  <ul>
    <li>–î–æ–º–∞—à–Ω–∏–µ —à–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ 20‚Äì30 –º–∏–Ω—É—Ç</li>
    <li>–ì–æ—Ç–æ–≤—ã–µ –ø–ª–∞–Ω—ã –Ω–∞ –Ω–µ–¥–µ–ª—é</li>
    <li>–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è –≤ —á–∞—Ç–µ</li>
    <li>–ë–µ–∑ –ø—Ä—ã–∂–∫–æ–≤ –∏ —Å–ª–æ–∂–Ω–æ–π —Ö–æ—Ä–µ–æ–≥—Ä–∞—Ñ–∏–∏</li>
  </ul>
  <div class="actions">
    <a class="btn primary" id="cta" href="https://walk-walk.ru/?utm_source=website&utm_medium=quiz&utm_campaign=looseweight" target="_blank" rel="noopener">–ü–æ–ª—É—á–∏—Ç—å –∞–±–æ–Ω–µ–º–µ–Ω—Ç —Å–æ —Å–∫–∏–¥–∫–æ–π</a>
    <button class="btn ghost" data-prev>–ù–∞–∑–∞–¥</button>
  </div>
`);
screensRoot.innerHTML=html;

/* progress header */
const progress=$('#progress');
progress.innerHTML=`<div class="pcirc"><div class="pct">0%</div></div><div class="plogo"><img src="logo.png" alt="–®–ê–ì–ê–ô –î–û–ú–ê"></div>`;
const pcirc=()=>$('#progress .pcirc'),pcText=()=>$('#progress .pct');let pctNow=0,rafId=0;
function animProg(to){cancelAnimationFrame(rafId);const k=.08,d=.75;let v=0;function f(){const x=pctNow-to,a=-k*x;v=(v+a)*d;pctNow+=v;if(Math.abs(pctNow-to)<.3&&Math.abs(v)<.3)pctNow=to;pcirc().style.setProperty('--p',pctNow.toFixed(1)+'%');pcText().textContent=Math.round(pctNow)+'%';if(pctNow!==to)rafId=requestAnimationFrame(f)}rafId=requestAnimationFrame(f)}
let idx=0;const S=$$('#screens .screen');
function setP(i){progress.classList.toggle('hide',i===0);const p=Math.round(i/(S.length-1)*100);animProg(p)}
function show(n){S[idx].classList.remove('is');idx=Math.max(0,Math.min(S.length-1,n));S[idx].classList.add('is');setP(idx);scrollTo({top:0,behavior:'smooth'})}
setP(0);
addEventListener('click',e=>{const next=e.target.closest('[data-next]'),prev=e.target.closest('[data-prev]');if(next){vibrate();goNext()}if(prev){vibrate();show(idx-1)}});

function shake(){S[idx].animate([{transform:'translateX(0)'},{transform:'translateX(-6px)'},{transform:'translateX(6px)'},{transform:'translateX(0)'}],{duration:260});vibrate(25)}
const need=k=>!A[k];
function goNext(){const id=S[idx].dataset.id;
  if(id==='age'&&need('age'))return shake();
  if(id==='body'&&need('body'))return shake();
  if(id==='bmi'&&(!A.h||!A.w))return shake();
  if(id==='life'&&need('life'))return shake();
  if(id==='exp'&&need('exp'))return shake();
  if(id==='goal'&&(A.goalKg==null))return shake();
  if(id==='perweek'&&need('perweek'))return shake();
  show(idx+1)
}

/* inputs */
$('#name').oninput=e=>{A.name=e.target.value.trim();save()};
const steps=$('#steps'),sv=$('#sv');function updRange(){const min=+steps.min||0,max=+steps.max||100,val=+steps.value||0,p=((val-min)/(max-min))*100;steps.style.setProperty('--pct',p+'%')}
if(steps){updRange();steps.oninput=e=>{A.steps=+e.target.value;sv.textContent=A.steps;updRange();save()}}

/* BMI calc + label */
['h','w'].forEach(id=>{$('#'+id)?.addEventListener('input',()=>{updBMI();updateGoalPreview()})});
function bmiCat(b){if(b<18.5)return{label:'–î–µ—Ñ–∏—Ü–∏—Ç –º–∞—Å—Å—ã',cls:'bmi-warn',note:'–Ω–∏–∂–µ –Ω–æ—Ä–º—ã (18,5‚Äì24,9)'};if(b<25)return{label:'–ù–æ—Ä–º–∞',cls:'bmi-ok',note:'–≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã'};if(b<30)return{label:'–ò–∑–±—ã—Ç–æ—á–Ω–∞—è –º–∞—Å—Å–∞',cls:'bmi-warn',note:'–≤—ã—à–µ –Ω–æ—Ä–º—ã'};if(b<35)return{label:'–û–∂–∏—Ä–µ–Ω–∏–µ I —Å—Ç.',cls:'bmi-bad',note:'–≤—ã—à–µ –Ω–æ—Ä–º—ã'};if(b<40)return{label:'–û–∂–∏—Ä–µ–Ω–∏–µ II —Å—Ç.',cls:'bmi-bad',note:'–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ –Ω–æ—Ä–º—ã'};return{label:'–û–∂–∏—Ä–µ–Ω–∏–µ III —Å—Ç.',cls:'bmi-bad',note:'–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –≤—ã—à–µ –Ω–æ—Ä–º—ã'}}
function updBMI(){const h=+$('#h').value,w=+$('#w').value;if(h>0&&w>0){A.h=h;A.w=w;const m=h/100;A.bmi=+(w/(m*m)).toFixed(1);save();const c=bmiCat(A.bmi);$('#bmiI').innerHTML=`–í–∞—à –ò–ú–¢: <b>${A.bmi}</b> <span class="bmi-tag ${c.cls}">${c.label}</span><br><span class="hint bmi-line">–ò–ú–¢ –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –º–∞—Å—Å–µ —Ç–µ–ª–∞; –Ω–æ—Ä–º–∞ ‚Äî 18,5‚Äì24,9. –£—á–∏—Ç—ã–≤–∞–π—Ç–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏—è, –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å –∏ –º—ã—à–µ—á–Ω—É—é –º–∞—Å—Å—É.</span>`}else{$('#bmiI').textContent=''}}

/* generic selectors */
function selectList(root,key,single){if(!root)return;root.addEventListener('click',e=>{const sel=e.target.closest(single?'.opt':'.chip');if(!sel)return;if(single){$$('.opt',root).forEach(x=>x.classList.remove('is'));sel.classList.add('is');A[key]=sel.dataset.v||sel.textContent}else{sel.classList.toggle('is');A[key]=$$('.chip.is',root).map(x=>x.dataset.v||x.textContent)}save();vibrate(8)})}
selectList($('#ageOpts'),'age',true);
selectList($('#bodyOpts'),'body',true);
selectList($('#lifeOpts'),'life',true);
selectList($('#expOpts'),'exp',true);
selectList($('#motChips'),'mot',false);
selectList($('#pwChips'),'perweek',false);
selectList($('#healthChips'),'health',false);
selectList($('#bad'),'bad',false);
selectList($('#good'),'good',false);
selectList($('#nutriOpts'),'nutri',true);

/* habit meter */
function nutrPreview(){const b=(A.bad||[]).length,g=(A.good||[]).length;let f=1;f+=g*.02;f-=b*.03;return Math.max(.7,Math.min(1.35,f))}
function updMeter(){const f=nutrPreview(),acc=Math.round((f-1)*100),ptr=$('#hmPtr'),track=$('#hmTrack'),score=$('#hmScore'),badge=$('#hmBadge'),min=-30,max=35,clamp=Math.max(min,Math.min(max,acc)),p=((clamp-min)/(max-min))*100;track.style.setProperty('--p',p+'%');ptr.style.left=p+'%';score.textContent=(acc>0?'+':'')+acc+'%';let cls='hm-ok',txt='–Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ',border='#FFBA08';if(acc<=-15){cls='hm-bad';txt='—Å–∏–ª—å–Ω–æ —Ç–æ—Ä–º–æ–∑–∏—Ç';border='#E85D04'}else if(acc<-5){cls='hm-b–∞–¥';txt='—Ç–æ—Ä–º–æ–∑–∏—Ç';border='#E85D04'}else if(acc>15){cls='hm-good';txt='—Å—É–ø–µ—Ä—É—Å–∫–æ—Ä–µ–Ω–∏–µ';border='#12A06A'}else if(acc>5){cls='hm-good';txt='—É—Å–∫–æ—Ä—è–µ—Ç';border='#12A06A'}badge.className='hm-badge '+cls;badge.textContent=txt;ptr.style.borderColor=border}
(()=>{['bad','good'].forEach(id=>{$('#'+id)?.addEventListener('click',()=>setTimeout(updMeter,0),true)});updMeter()})();

/* hard cards tilt */
(function setupHard(){const w=$('#hardCards');if(!w)return;const cs=$$('.hcard',w);if(A.hardKey){cs.find(c=>c.dataset.k===A.hardKey)?.classList.add('is')}w.addEventListener('click',e=>{const c=e.target.closest('.hcard');if(!c)return;cs.forEach(x=>x.classList.toggle('is',x===c));A.hardKey=c.dataset.k;A.hard={'walk':'–î–æ–ª–≥–∞—è –ø—Ä–æ–≥—É–ª–∫–∞ —É—Ç–æ–º–ª—è–µ—Ç','stairs':'–ö–∞–∂–¥—ã–π –ø—Ä–æ–ª—ë—Ç –ø–æ –ª–µ—Å—Ç–Ω–∏—Ü–µ ‚Äî –∏—Å–ø—ã—Ç–∞–Ω–∏–µ','games':'–°—Ç—ã–¥–Ω–æ –≤–∫–ª—é—á–∞—Ç—å—Å—è –≤ –∞–∫—Ç–∏–≤–Ω—ã–µ –∏–≥—Ä—ã','jumps':'–ü—Ä—ã–∂–∫–∏','none':'–ù–∏—á–µ–≥–æ –∏–∑ —ç—Ç–æ–≥–æ'}[A.hardKey];save();vibrate(8)});cs.forEach(c=>{c.addEventListener('pointermove',e=>{const r=c.getBoundingClientRect(),x=(e.clientX-r.left)/r.width,y=(e.clientY-r.top)/r.height,rx=(.5-y)*8,ry=(x-.5)*10;c.style.transform=`rotateX(${rx}deg) rotateY(${ry}deg)`});['pointerleave','pointercancel','blur'].forEach(ev=>c.addEventListener(ev,()=>{c.style.transform=''}))})})();

/* ===== Goal logic with 9 PNG and BMI realism ===== */
const clamp01=v=>Math.max(0,Math.min(1,v));
/* BMI anchors for silhouettes (index 0..8) */
const BMI_ANCHORS=[18.8,20.0,21.8,23.5,26.0,29.0,32.0,35.0,38.0];
function indexFromBMI(bmi){
  const B=BMI_ANCHORS, N=B.length-1;
  if(bmi<=B[0]) return 0;
  if(bmi>=B[N]) return N;
  for(let i=0;i<N;i++){
    if(bmi>=B[i] && bmi<=B[i+1]){
      const t=(bmi-B[i])/(B[i+1]-B[i]);
      return i+t;
    }
  }
  return N;
}
function bodyToIndex(bodyKey,N){const frac={slim:3/8,avg:5/8,large:7/8,obese:1.0}[bodyKey] ?? 5/8;return frac*(N-1)}
function crossfade(imgs,t){
  const N=imgs.length-1,tt=Math.max(0,Math.min(N,t));
  const iLo=Math.floor(tt), iHi=Math.ceil(tt), f=tt-iLo;
  imgs.forEach(img=>{img.style.opacity=0;img.style.transform='scale(1)'});
  if(iLo===iHi){ if(imgs[iLo]) imgs[iLo].style.opacity=1; }
  else{
    const lo=imgs[iLo],hi=imgs[iHi];
    if(lo){ lo.style.opacity=1-f; lo.style.transform=`scale(${1-0.02*f})`; }
    if(hi){ hi.style.opacity=f;   hi.style.transform=`scale(${1-0.03*(1-f)})`; }
  }
}
function updateGoalPreview(){
  const stack=$('#goalStack'); if(!stack) return;
  const imgs=Array.from(stack.querySelectorAll('img[data-i]')).sort((a,b)=>(+a.dataset.i)-(+b.dataset.i));
  const N=imgs.length; if(N<1) return;

  // —Ä–µ–∂–∏–º "–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ñ–∏–≥—É—Ä—É" ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º fit.png
  const keepOn=$('#goalKeep')?.checked || !!A.keep;
  if(keepOn){
    imgs.forEach(img=>{img.style.opacity=0;img.style.transform='scale(1)'});
    const fit = imgs.find(img => /(^|\/)fit\.png$/i.test(img.getAttribute('src')||'')) || imgs[1];
    if(fit) fit.style.opacity=1;
    return;
  }

  const kg=+A.goalKg||0;
  const h=+A.h>0?A.h/100:null, w=+A.w>0?+A.w:null;

  if(h && w){
    const w2=Math.max(0.1, w - kg);                 // –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã–π –≤–µ—Å
    const bmi2=w2/(h*h);                            // –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã–π –ò–ú–¢
    const t=indexFromBMI(bmi2);                     // —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∏–Ω–¥–µ–∫—Å
    crossfade(imgs,t);
  }else{
    // –µ—Å–ª–∏ –Ω–µ—Ç —Ä–æ—Å—Ç–∞/–≤–µ—Å–∞ ‚Äî –º—è–≥–∫–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –æ—Ç —Ç–µ–∫—É—â–µ–≥–æ —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏—è
    const start=bodyToIndex(A.body||'avg',N);
    const t=Math.max(0,start - (kg/4));            // ~4 –∫–≥ –Ω–∞ –æ–¥–∏–Ω —à–∞–≥ —Å–∏–ª—É—ç—Ç–∞
    crossfade(imgs,t);
  }
}
function gBucket(kg){const v=+kg;if(v<=0)return'–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ñ–∏–≥—É—Ä—É / –≤–µ—Ä–Ω—É—Ç—å —Ç–æ–Ω—É—Å';if(v<=5)return'–°–±—Ä–æ—Å–∏—Ç—å 3‚Äì5 –∫–≥';if(v<=10)return'–°–±—Ä–æ—Å–∏—Ç—å 5‚Äì10 –∫–≥';return'–°–±—Ä–æ—Å–∏—Ç—å 10+ –∫–≥'}
function updGoal(){const kg=+A.goalKg||0;$('#goalVal').textContent=kg.toFixed(1);const b=$('#goalBadge');let cls='goal-mid',txt='—É–º–µ—Ä–µ–Ω–Ω–æ';if(kg===0){cls='goal-soft';txt='–ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏–µ'}else if(kg<=5){cls='goal-soft';txt='–º—è–≥–∫–æ'}else if(kg<=10){cls='goal-mid';txt='—É–º–µ—Ä–µ–Ω–Ω–æ'}else{cls='goal-hard';txt='–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ'}b.className='goal-badge '+cls;b.textContent=txt;const rng=$('#goalRange'),pct=kg/(+rng.max)*100;rng.style.setProperty('--pct',pct+'%');updateGoalPreview()}
function setGoal(val){const kg=Math.max(0,Math.min(20,+val||0));A.goalKg=kg;A.goal=gBucket(kg);save();updGoal()}
function toggleKeep(ch){const rng=$('#goalRange');A.keep=!!ch;save();if(ch){rng.disabled=true;setGoal(0)}else{rng.disabled=false;if((+A.goalKg||0)===0)setGoal(5)}updateGoalPreview()}
const goalR=$('#goalRange'),goalK=$('#goalKeep');
goalR.oninput=e=>setGoal(e.target.value);goalK.onchange=e=>toggleKeep(e.target.checked);
(()=>{const kg=(A.goalKg!=null)?+A.goalKg:5;goalR.value=kg;const keep=(A.keep===true)||kg===0;goalK.checked=keep;toggleKeep(keep);if(!keep)setGoal(kg);updateGoalPreview()})();

/* Loading + result */
function runLoading(done){const ring=$('#lring'),lpct=$('#lpct'),lmsg=$('#lmsg'),lsub=$('#lsub'),stepsTxt=['–£—á–∏—Ç—ã–≤–∞–µ–º –≤–∞—à –≤–æ–∑—Ä–∞—Å—Ç','–°–º–æ—Ç—Ä–∏–º —Ç–µ–ª–æ—Å–ª–æ–∂–µ–Ω–∏–µ –∏ –ò–ú–¢','–ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –æ–ø—ã—Ç','–î–æ–±–∞–≤–ª—è–µ–º —à–∞–≥–∏ –∏ –ø–∏—Ç–∞–Ω–∏–µ','–ì–æ—Ç–æ–≤–∏–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑‚Ä¶'];let si=0;lmsg.textContent=stepsTxt[0];lsub.textContent='–í–æ–∑—Ä–∞—Å—Ç ‚Ä¢ –ò–ú–¢ ‚Ä¢ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å ‚Ä¢ –¶–µ–ª—å';const D=1500,t0=performance.now();function tick(n){const p=Math.min(1,(n-t0)/D),ease=1-Math.pow(1-p,3),pct=Math.round(5+95*ease);ring.style.setProperty('--p',pct+'%');lpct.textContent=pct+'%';const i=Math.min(stepsTxt.length-1,Math.floor(p*stepsTxt.length));if(i!==si){si=i;lmsg.textContent=stepsTxt[si]}if(p<1)requestAnimationFrame(tick);else setTimeout(()=>done(),200)}requestAnimationFrame(tick)}
const idxBy=id=>$$('#screens .screen').findIndex(s=>s.dataset.id===id);
$('#calc').onclick=()=>{show(idx+1);runLoading(calculate)};

function goalKg(){if(A.goalKg!=null)return Math.max(0,Math.min(20,+A.goalKg));const g=A.goal||'';if(g.includes('3‚Äì5'))return 4;if(g.includes('5‚Äì10'))return 8;if(g.includes('10+'))return 12;return 3}
const fAge=()=>(/50/.test(A.age||''))?.88:(/40/.test(A.age||''))?.94:(/30/.test(A.age||''))?.98:1.06;
const fLife=()=>(/–°–∏–¥—è—á–∞—è/.test(A.life||''))?.90:(/–£–º–µ—Ä–µ–Ω–Ω–æ/.test(A.life||''))?1.00:1.08;
const fExp =()=>(/–ù–∏–∫–æ–≥–¥–∞/.test(A.exp||''))?.95:(/–†–µ–≥—É–ª—è—Ä–Ω–æ/.test(A.exp||''))?1.08:1.00;
function fBody(){switch(A.body){case 'slim':return .92;case 'avg':return 1.00;case 'large':return .96;case 'obese':return .92;default:return 1.00}}
function fSteps(){const now=+A.steps||4000,add=2000,t=now+add;let boost=1+add/10000;if(now<3000)boost+=.08;if(now>9000)boost-=.06;return{f:Math.max(.95,Math.min(1.28,boost)),t}}
function fNutri(){let f=1;if(A.nutri==='menu')f+=.22;else if(A.nutri==='plate')f+=.12;else f-=.12;f-=((A.bad||[]).length)*.03;f+=Math.min(((A.good||[]).length)*.02,.10);return Math.max(.7,Math.min(1.35,f))}
function fHealth(){const h=new Set(A.health||[]);let f=1;if(h.has('–î–∏–∞–±–µ—Ç')||h.has('–ü—Ä–æ–±–ª–µ–º—ã —Å–æ —â–∏—Ç–æ–≤–∏–¥–∫–æ–π')||h.has('–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è'))f-=.06;if(h.has('–ë–æ–ª—å –≤ —Å—É—Å—Ç–∞–≤–∞—Ö'))f-=.04;return Math.max(.8,f)}
function fPain(){switch(A.hardKey){case 'walk':return .94;case 'stairs':return .93;case 'games':return .96;case 'jumps':return .95;case 'none':return 1.02;default:return 1.00}}
// –°–∫–æ—Ä–æ—Å—Ç—å —Å–Ω–∏–∂–µ–Ω–∏—è –≤–µ—Å–∞ (–∫–≥/–Ω–µ–¥)
function rate(){
  const w = +A.w || 0;            // —Ç–µ–∫—É—â–∏–π –≤–µ—Å –∏–∑ —à–∞–≥–∞ –ò–ú–¢
  if (w >= 100) return 1.0;       // —Ñ–∏–∫—Å 1 –∫–≥/–Ω–µ–¥ –¥–ª—è 100+ –∫–≥

  // –ø—Ä–µ–∂–Ω—è—è –ª–æ–≥–∏–∫–∞ –¥–ª—è –≤—Å–µ—Ö –æ—Å—Ç–∞–ª—å–Ω—ã—Ö
  let r = .5;
  const bmi = A.bmi || 26;
  if (bmi >= 30) r += .08; else if (bmi < 23) r -= .08;
  r *= fAge()*fLife()*fExp()*fBody()*fSteps().f*fNutri()*fHealth()*fPain();
  return Math.max(.25, Math.min(.9, +r.toFixed(2)));
}
function calculate(){
  const name=A.name?.trim()||'–î—Ä—É–∑—å—è',kg=goalKg(),rt=rate(),wks=Math.max(4,Math.min(16,Math.ceil(kg/rt))),t=fSteps().t;
  $('#rTitle').textContent=`${name}, –≤–∞—à –ø—Ä–æ–≥–Ω–æ–∑ –≥–æ—Ç–æ–≤ ‚ú®`;
  animNum(12,wks,1400,v=>{$('#nums').textContent=`‚àí${kg} –∫–≥ –∑–∞ ${v} –Ω–µ–¥–µ–ª—å`});
  const rtText=rt.toLocaleString('ru-RU',{minimumFractionDigits:1,maximumFractionDigits:1});
  $('#rSub').innerHTML=`–° —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞–º–∏ –®–ê–ì–ê–ô –î–û–ú–ê ‚ö°Ô∏è –≤—ã –±—É–¥–µ—Ç–µ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å <b>${t.toLocaleString('ru-RU')}</b> —à–∞–≥–æ–≤ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å!<br><span class="hint">–û—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ç–µ–º–ø —Å–Ω–∏–∂–µ–Ω–∏—è –≤–µ—Å–∞: <b>~${rtText} –∫–≥/–Ω–µ–¥–µ–ª—é</b>.</span>`;
  $('#sTitle').textContent=`${name}, –ø—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –∫–ª—É–±—É ¬´–®–ê–ì–ê–ô –î–û–ú–ê¬ª ‚ö°`;
  $('#sLead').innerHTML=`–ß—Ç–æ–±—ã –ø—Ä–∏–π—Ç–∏ –∫ —Ü–µ–ª–∏ <b>‚àí${kg} –∫–≥</b> –∑–∞ <b>${wks} –Ω–µ–¥–µ–ª—å</b> ‚Äî –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –ø–ª–∞–Ω—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫—É. –ü–µ—Ä–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —É–∂–µ —á–µ—Ä–µ–∑ 1‚Äì2 –Ω–µ–¥–µ–ª–∏.`;
  show(idxBy('result'))
}
function animNum(a,b,d,cb){const s=performance.now(),ease=t=>1-Math.pow(1-t,3);function fr(n){const p=Math.min(1,(n-s)/d);cb(Math.round(a+(b-a)*ease(p)));if(p<1)requestAnimationFrame(fr)}requestAnimationFrame(fr)}
$('#toCTA').onclick=()=>show(idxBy('sale'));

/* hero skeleton hide */
const hv=document.querySelector('video.hero-media'),hs=document.getElementById('heroSkel');
function hideS(){hs&&hs.classList.add('hide')}
hv?.addEventListener('loadeddata',hideS,{once:true});
hv?.addEventListener('canplay',hideS,{once:true});
setTimeout(hideS,2000);

/* start */
const pcInit=()=>{try{scrollTo({top:0,behavior:'auto'})}catch(e){scrollTo(0,0)}};pcInit();setP(0);
</script>
</body>
</html>
