<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–ü–æ–¥–±–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã ‚Äî –®–ê–ì–ê–ô –î–û–ú–ê</title>
<style>
:root{
  --bg:#0b1020;--card:#101629;--ink:#eaf0ff;--muted:#9fb1d9;
  --accent:#ff4b4b;--accent2:#ffd46b;--ok:#22c55e;
  --line:#26314c;--rad:18px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;background:
    radial-gradient(1000px 600px at 20% -10%,#1b2750 0%,#0f1733 60%,#0b1020 100%),
    linear-gradient(#0b1020,#0b1020);
  color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",Arial,sans-serif;
}
.wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:18px}
.card{
  width:min(960px,100%);background:linear-gradient(180deg,#111735,#0e142c);
  border:1px solid var(--line);border-radius:var(--rad);box-shadow:0 30px 80px rgba(0,0,0,.5);
  padding:0;overflow:hidden;
}
.header{padding:18px 18px 10px 18px;display:flex;gap:12px;align-items:center;justify-content:space-between}
h1{margin:0;font-size:22px;font-weight:800;letter-spacing:.2px}
.brand{display:flex;align-items:center;gap:10px}
.brand .logo{width:36px;height:36px;border-radius:50%;background:#fff;display:grid;place-content:center;font-weight:900;color:#111}
.brand .title{display:flex;flex-direction:column}
.brand .title b{font-size:15px}
.brand .title span{font-size:12px;color:var(--muted)}

.progress{padding:0 18px 16px}
.bar{height:10px;border-radius:999px;background:#141b35;position:relative;overflow:hidden}
.fill{position:absolute;inset:0 100% 0 0;background:linear-gradient(90deg,#ff6d6d,#ffb86b);border-radius:999px;transition:inset .35s}
.pct{margin-top:6px;font-size:12px;color:var(--muted)}

.stage{position:relative;min-height:56vh;padding:16px 18px 100px}
.step{position:absolute;inset:0;opacity:0;transform:translateY(8px);transition:.35s}
.step.active{opacity:1;transform:none}
.step.out{opacity:0;transform:translateY(-8px)}

.q{font-size:26px;line-height:1.15;margin:4px 0 14px}
.sub{color:var(--muted);font-size:14px;margin:0 0 16px}

.grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
.opt{
  display:flex;gap:10px;align-items:center;padding:14px;border:1px solid var(--line);border-radius:14px;
  background:linear-gradient(180deg,#121939,#0f1531);cursor:pointer;transition:.2s
}
.opt:hover{border-color:#364469;background:#121a3f}
.opt.sel{outline:3px solid var(--accent)}
.opt .ico{font-size:22px;width:28px;text-align:center}
.opt .t{font-size:16px}

.inputs{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}
.input{
  background:#0f1733;border:1px solid var(--line);border-radius:12px;padding:12px;display:flex;flex-direction:column
}
.input label{font-size:12px;color:var(--muted);margin-bottom:6px}
.input input{background:transparent;border:0;color:var(--ink);font-size:18px;outline:none}

.nav{
  position:sticky;bottom:0;display:flex;gap:12px;justify-content:space-between;align-items:center;
  padding:12px 18px;background:linear-gradient(180deg,rgba(11,16,32,0),rgba(11,16,32,.9) 35%,#0b1020 60%);
}
.btn{border:0;border-radius:12px;padding:12px 18px;font-weight:800;cursor:pointer}
.btn.secondary{background:#1a2447;color:#e8eeff}
.btn.primary{background:linear-gradient(90deg,#ff6d6d,#ff9f6b);color:#1a0b0b}
.btn:disabled{opacity:.55;cursor:not-allowed}

.center{display:grid;place-content:center;text-align:center;height:100%}
.spinner{width:46px;height:46px;border:4px solid #2a3357;border-top-color:#ff8a6b;border-radius:50%;margin:8px auto 12px;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

.result{padding:22px 18px 26px;text-align:center}
.badge{width:170px;height:170px;margin:8px auto 10px;border-radius:50%;
  background:radial-gradient(circle at 50% 40%,#ffe6ea,#ff98ac 60%,#ff617d);box-shadow:0 18px 40px rgba(255,77,94,.25)}
.badge b{font-size:64px;display:block;line-height:170px}
.plan{font-size:24px;margin:6px 0 8px}
.desc{color:#f3f6ff;opacity:.92;max-width:720px;margin:0 auto 12px;line-height:1.55}
.buy{display:inline-block;margin-top:10px;padding:14px 24px;border-radius:999px;
  background:linear-gradient(90deg,#ff6d6d,#ffb86b);color:#1a0b0b;text-decoration:none;font-weight:900}
.alt{display:block;margin-top:10px;color:#c5d2ff;text-decoration:underline}
.note{font-size:12px;color:#9fb1d9;margin-top:8px}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" id="app">
    <div class="header">
      <div class="brand">
        <div class="logo">üèÉ‚Äç‚ôÄÔ∏è</div>
        <div class="title"><b>–®–ê–ì–ê–ô –î–û–ú–ê</b><span>–ø–æ–¥–±–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã</span></div>
      </div>
      <h1>–ù–∞–π–¥—ë–º –∏–¥–µ–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h1>
    </div>

    <div class="progress">
      <div class="bar"><div class="fill" id="fill"></div></div>
      <div class="pct" id="pct">0%</div>
    </div>

    <div class="stage" id="stage"></div>

    <div class="nav">
      <button class="btn secondary" id="back">–ù–∞–∑–∞–¥</button>
      <button class="btn primary" id="next" disabled>–î–∞–ª–µ–µ</button>
    </div>
  </div>
</div>

<script>
/* ====== –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ====== */
const ASK_EMAIL = false; // –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ ‚Äî –ø–æ—Å—Ç–∞–≤—å true (–ø–µ—Ä–µ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º –ø–æ—è–≤–∏—Ç—Å—è –≤–≤–æ–¥ e-mail)

/* –ü—Ä–æ–≥—Ä–∞–º–º—ã –∏ —Å—Å—ã–ª–∫–∏ (–∑–∞–º–µ–Ω–∏ buy –Ω–∞ —Å–≤–æ–∏) */
const PLANS = {
  start45:{title:"–ö–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π —Å—Ç–∞—Ä—Ç 45+",icon:"ü´∂",
    desc:"–©–∞–¥—è—â–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –±–µ–∑ –ø—Ä—ã–∂–∫–æ–≤, –º—è–≥–∫–æ–µ –∂–∏—Ä–æ—Å–∂–∏–≥–∞–Ω–∏–µ, –∑–∞–±–æ—Ç–∞ –æ —Å—É—Å—Ç–∞–≤–∞—Ö.",
    buy:"https://walk-walk.ru/checkout?plan=start45"},
  fatburn:{title:"–ñ–∏—Ä–æ—Å–∂–∏–≥–∞–Ω–∏–µ Light",icon:"üî•",
    desc:"–®–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∏ —Ç–∞–Ω—Ü–µ–≤–∞–ª—å–Ω—ã–µ –∫–∞—Ä–¥–∏–æ-—Å–≤—è–∑–∫–∏ –≤ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º —Ç–µ–º–ø–µ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –≤–µ—Å–∞.",
    buy:"https://walk-walk.ru/checkout?plan=fatburn"},
  tone:{title:"–¢–æ–Ω—É—Å –∏ –æ—Å–∞–Ω–∫–∞",icon:"üéØ",
    desc:"–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–ª–µ–∫—Å—ã –Ω–∞ —Å–ø–∏–Ω—É –∏ –∫–æ—Ä–ø—É—Å: –ø–æ–¥—Ç—è–Ω—É—Ç–∞—è –æ—Å–∞–Ω–∫–∞ –∏ –∫—Ä–µ–ø–∫–∏–π —Ü–µ–Ω—Ç—Ä.",
    buy:"https://walk-walk.ru/checkout?plan=tone"},
  party:{title:"–®–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∏—Å–∫–æ—Ç–µ–∫–∏",icon:"üéµ",
    desc:"–ú—É–∑—ã–∫–∞, –ø—Ä–æ—Å—Ç—ã–µ —Ä–∏—Ç–º—ã, –º–Ω–æ–≥–æ —à–∞–≥–æ–≤ ‚Äî —Ö—É–¥–µ–µ–º ¬´–Ω–∞ —Ä–∞–¥–æ—Å—Ç—è—Ö¬ª.",
    buy:"https://walk-walk.ru/checkout?plan=party"},
  mobility:{title:"–ü–æ–¥–≤–∏–∂–Ω–æ—Å—Ç—å –∏ —Ä–∞—Å—Ç—è–∂–∫–∞",icon:"üßò‚Äç‚ôÄÔ∏è",
    desc:"–ì–∏–±–∫–æ—Å—Ç—å, —Å—É—Å—Ç–∞–≤–Ω–∞—è –º–æ–±–∏–ª–∏–∑–∞—Ü–∏—è –∏ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ ‚Äî –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ –ª—é–±–æ–º—É –ø–ª–∞–Ω—É.",
    buy:"https://walk-walk.ru/checkout?plan=mobility"},
  fast20:{title:"–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç 20‚Äì25 –º–∏–Ω—É—Ç",icon:"‚è±Ô∏è",
    desc:"–ö–æ—Ä–æ—Ç–∫–∏–µ, –Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è, –∫–æ–≥–¥–∞ –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –¥–ª–∏–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏.",
    buy:"https://walk-walk.ru/checkout?plan=fast20"}
};

/* –®–∞–≥–∏ ‚Äî –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ ¬´–∫–∞–∫ –≤ –ø—Ä–∏–º–µ—Ä–µ¬ª: –æ–¥–∏–Ω —ç–∫—Ä–∞–Ω = –æ–¥–∏–Ω –≤–æ–ø—Ä–æ—Å */
const STEPS = [
  {type:"choice", q:"–í–∞—à–∞ –≥–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å –Ω–∞ 4 –Ω–µ–¥–µ–ª–∏:", options:[
    {t:"–ü–æ—Ö—É–¥–µ—Ç—å –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ",plan:"fatburn",ico:"üî•"},
    {t:"–ù–∞—á–∞—Ç—å –º—è–≥–∫–æ (45+)",plan:"start45",ico:"ü´∂"},
    {t:"–ü–æ–¥—Ç—è–Ω—É—Ç—å –∫–æ—Ä–ø—É—Å/–æ—Å–∞–Ω–∫—É",plan:"tone",ico:"üéØ"},
    {t:"–î–≤–∏–∂–µ–Ω–∏–µ –ø–æ–¥ –º—É–∑—ã–∫—É",plan:"party",ico:"üéµ"},
    {t:"–ì–∏–±–∫–æ—Å—Ç—å –∏ –ª—ë–≥–∫–æ—Å—Ç—å",plan:"mobility",ico:"üßò‚Äç‚ôÄÔ∏è"},
    {t:"–ö–æ—Ä–æ—Ç–∫–∏–µ –∑–∞–Ω—è—Ç–∏—è 20‚Äì25 –º–∏–Ω",plan:"fast20",ico:"‚è±Ô∏è"}
  ]},
  {type:"choice", q:"–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:", options:[
    {t:"–ù–æ–≤–∏—á–æ–∫ / –ø–µ—Ä–µ—Ä—ã–≤",plan:"start45",ico:"üå±"},
    {t:"–†–µ–¥–∫–æ –¥–≤–∏–≥–∞—é—Å—å",plan:"fast20",ico:"‚åõ"},
    {t:"–°—Ä–µ–¥–Ω–∏–π",plan:"fatburn",ico:"üôÇ"},
    {t:"–•–æ—Ä–æ—à–∏–π, –Ω–æ —Ö–æ—á—É –±–µ–∑ –ø—Ä—ã–∂–∫–æ–≤",plan:"party",ico:"üé∂"},
    {t:"–ù—É–∂–µ–Ω –∞–∫—Ü–µ–Ω—Ç –Ω–∞ —Å–ø–∏–Ω—É/–∫–æ—Ä–ø—É—Å",plan:"tone",ico:"üéØ"}
  ]},
  {type:"choice", q:"–°–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ —É–¥–µ–ª—è—Ç—å –≤ –¥–µ–Ω—å?", options:[
    {t:"10‚Äì15 –º–∏–Ω—É—Ç",plan:"fast20",ico:"‚è±Ô∏è"},
    {t:"20‚Äì25 –º–∏–Ω—É—Ç",plan:"fast20",ico:"‚è±Ô∏è"},
    {t:"30‚Äì40 –º–∏–Ω—É—Ç",plan:"fatburn",ico:"üî•"},
    {t:"40+ –º–∏–Ω—É—Ç",plan:"tone",ico:"üéØ"}
  ]},
  {type:"inputs", q:"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥–±–æ—Ä–∞",
    sub:"–†–æ—Å—Ç –∏ –≤–µ—Å –ø–æ–º–æ–≥—É—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–µ–µ –ø–æ–¥–æ–±—Ä–∞—Ç—å —Ç–µ–º–ø. (–ú–æ–∂–Ω–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ)",
    fields:[
      {id:"height",label:"–†–æ—Å—Ç (—Å–º)",min:130,max:220,placeholder:"165"},
      {id:"weight",label:"–í–µ—Å (–∫–≥)",min:35,max:180,placeholder:"70"}
    ]
  },
  {type:"choice", q:"–ï—Å—Ç—å –ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è?", options:[
    {t:"–ö–æ–ª–µ–Ω–∏/—Å—É—Å—Ç–∞–≤—ã, –Ω—É–∂–Ω–∞ —â–∞–¥—è—â–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞",plan:"start45",ico:"ü¶µ"},
    {t:"–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è —Å–ø–∏–Ω–∞/—à–µ—è",plan:"tone",ico:"üßç‚Äç‚ôÄÔ∏è"},
    {t:"–ù–µ—Ç —Å–µ—Ä—å—ë–∑–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π",plan:"fatburn",ico:"üí™"},
    {t:"–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –Ω–∏–∑–∫—É—é —É–¥–∞—Ä–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É",plan:"mobility",ico:"üßò‚Äç‚ôÄÔ∏è"}
  ]},
  {type:"choice", q:"–ö–∞–∫–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã –Ω—Ä–∞–≤—è—Ç—Å—è –±–æ–ª—å—à–µ?", options:[
    {t:"–®–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ/—Ç–∞–Ω—Ü–µ–≤–∞–ª—å–Ω—ã–µ",plan:"party",ico:"üéµ"},
    {t:"–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞ –∫–æ—Ä–ø—É—Å",plan:"tone",ico:"üéØ"},
    {t:"–ö–∞—Ä–¥–∏–æ + –Ω–µ–º–Ω–æ–≥–æ —Å–∏–ª–æ–≤—ã—Ö",plan:"fatburn",ico:"üî•"},
    {t:"–†–∞—Å—Ç—è–∂–∫–∞ –∏ –¥—ã—Ö–∞–Ω–∏–µ",plan:"mobility",ico:"üßò‚Äç‚ôÄÔ∏è"},
    {t:"–ö–æ—Ä–æ—Ç–∫–∏–µ —ç–∫—Å–ø—Ä–µ—Å—Å-–∑–∞–Ω—è—Ç–∏—è",plan:"fast20",ico:"‚è±Ô∏è"},
    {t:"–ú—è–≥–∫–æ 45+",plan:"start45",ico:"ü´∂"}
  ]},
  {type:"choice", q:"–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å:", options:[
    {t:"–ë–µ–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è",plan:"party",ico:"üö´"},
    {t:"–¢–æ–ª—å–∫–æ –∫–æ–≤—Ä–∏–∫",plan:"mobility",ico:"üßò"},
    {t:"–†–µ–∑–∏–Ω–∫–∏/–≥–∞–Ω—Ç–µ–ª–∏ light",plan:"fatburn",ico:"üèãÔ∏è"},
    {t:"–ú—è—á/—Ä–æ–ª–ª/–ª–µ–Ω—Ç–∞",plan:"tone",ico:"üß∂"}
  ]},
  {type:"choice", q:"–¢–µ–º–ø –∑–∞–Ω—è—Ç–∏–π:", options:[
    {t:"–°–ø–æ–∫–æ–π–Ω—ã–π",plan:"mobility",ico:"ü´ß"},
    {t:"–ú—è–≥–∫–∏–π, –±–µ–∑ –ø—Ä—ã–∂–∫–æ–≤",plan:"start45",ico:"ü´∂"},
    {t:"–°—Ä–µ–¥–Ω–∏–π, –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π",plan:"fatburn",ico:"üôÇ"},
    {t:"–≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π, –Ω–æ –±–µ–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏",plan:"party",ico:"üé∂"},
    {t:"–° –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —Ç–µ—Ö–Ω–∏–∫—É",plan:"tone",ico:"üéØ"}
  ]},
  {type:"email", q:"–ö—É–¥–∞ –ø—Ä–∏—Å–ª–∞—Ç—å –ø–ª–∞–Ω –∏ –ø–µ—Ä–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É?",
    sub:"–ú—ã –Ω–µ –ø–∏—à–µ–º –ª–∏—à–Ω–µ–≥–æ –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—ë–º –∞–¥—Ä–µ—Å —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º.",
  },
  {type:"loading"} // ¬´–∞–Ω–∞–ª–∏–∑¬ª
];

/* ====== —Å–æ—Å—Ç–æ—è–Ω–∏–µ ====== */
let step = 0;
const scores = {};
const data   = {};
const stage  = document.getElementById('stage');
const fill   = document.getElementById('fill');
const pct    = document.getElementById('pct');
const nextBt = document.getElementById('next');
const backBt = document.getElementById('back');

/* ====== —É—Ç–∏–ª–∏—Ç—ã ====== */
const qs = (s,el=document)=>el.querySelector(s);
function setProgress(){
  const total = STEPS.length;
  const p = Math.round((Math.min(step, total-1))/ (total-1) * 100);
  fill.style.insetInlineEnd = (100-p)+'%';
  pct.textContent = p + '%';
}
function bump(plan, n=1){ scores[plan]=(scores[plan]||0)+n; }
function bmiScore(h, w){
  if(!h||!w) return;
  const m = w / Math.pow(h/100,2);
  if(m >= 27) bump('fatburn',2);
  else if(m >= 24) bump('fatburn',1);
  if(m < 22) bump('tone',1);
}

/* ====== —Ä–µ–Ω–¥–µ—Ä —à–∞–≥–∞ ====== */
function render(){
  setProgress();
  const prev = qs('.step.active', stage);
  if(prev){ prev.classList.remove('active'); prev.classList.add('out'); setTimeout(()=>prev.remove(),300); }

  const cfg = STEPS[step];
  const el  = document.createElement('div');
  el.className = 'step';
  stage.appendChild(el);

  nextBt.disabled = true;
  backBt.disabled = (step===0);

  if(cfg.type==='choice'){
    el.innerHTML = `
      <div class="q">${cfg.q}</div>
      ${cfg.sub?`<div class="sub">${cfg.sub}</div>`:''}
      <div class="grid">
        ${cfg.options.map(o=>`
          <button class="opt" data-plan="${o.plan}">
            <div class="ico">${o.ico||'‚Ä¢'}</div><div class="t">${o.t}</div>
          </button>`).join('')}
      </div>`;
    el.addEventListener('click',(e)=>{
      const btn = e.target.closest('.opt'); if(!btn) return;
      el.querySelectorAll('.opt').forEach(b=>b.classList.remove('sel'));
      btn.classList.add('sel'); nextBt.disabled=false;
      data['step'+step] = btn.textContent.trim();
      bump(btn.dataset.plan,1);
    });
  }

  if(cfg.type==='inputs'){
    el.innerHTML = `
      <div class="q">${cfg.q}</div>
      ${cfg.sub?`<div class="sub">${cfg.sub}</div>`:''}
      <div class="inputs">
        ${cfg.fields.map(f=>`
          <div class="input">
            <label for="${f.id}">${f.label}</label>
            <input id="${f.id}" type="number" inputmode="decimal"
              placeholder="${f.placeholder||''}" min="${f.min||''}" max="${f.max||''}"/>
          </div>`).join('')}
      </div>`;
    const h=qs('#height',el), w=qs('#weight',el);
    const validate = ()=>{
      const hv = Number(h?.value||h?.placeholder||0);
      const wv = Number(w?.value||w?.placeholder||0);
      nextBt.disabled = !(hv>=130 && hv<=220 && wv>=35 && wv<=180);
      if(!nextBt.disabled){ data.height=hv; data.weight=wv; }
    };
    el.addEventListener('input', validate);
    validate();
  }

  if(cfg.type==='email'){
    if(!ASK_EMAIL){ step++; render(); return; }
    el.innerHTML = `
      <div class="q">${cfg.q}</div>
      ${cfg.sub?`<div class="sub">${cfg.sub}</div>`:''}
      <div class="inputs" style="max-width:520px">
        <div class="input" style="grid-column:1/-1">
          <label for="email">–í–∞—à e-mail</label>
          <input id="email" type="email" placeholder="name@example.com"/>
        </div>
      </div>`;
    const em=qs('#email',el);
    const validate = ()=>{
      const ok = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(em.value);
      nextBt.disabled=!ok; if(ok) data.email=em.value;
    };
    el.addEventListener('input', validate);
    validate();
  }

  if(cfg.type==='loading'){
    el.innerHTML = `
      <div class="center">
        <div class="spinner"></div>
        <div class="sub">–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç—ã‚Ä¶</div>
      </div>`;
    nextBt.disabled = true; backBt.disabled = true;
    // –ø–æ–¥—Å—á—ë—Ç —Å —É—á—ë—Ç–æ–º BMI
    if(data.height && data.weight) bmiScore(data.height, data.weight);
    setTimeout(showResult, 1400);
  }

  requestAnimationFrame(()=>el.classList.add('active'));
}

/* ====== —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ====== */
document.getElementById('next').addEventListener('click',()=>{
  // –µ—Å–ª–∏ –±—ã–ª —à–∞–≥ inputs ‚Äî –ø—Ä–æ—Å—Ç–æ –¥–∞–ª—å—à–µ; –µ—Å–ª–∏ –±—ã–ª email ‚Äî —É–∂–µ –æ—Ç—Ä–∞–±–æ—Ç–∞–ª –≤ render
  step = Math.min(step+1, STEPS.length-1);
  render();
});
document.getElementById('back').addEventListener('click',()=>{
  if(step===0) return;
  step--; render();
});

/* ====== —Ä–µ–∑—É–ª—å—Ç–∞—Ç ====== */
function showResult(){
  const app = document.getElementById('app');
  const search = location.search ? '&'+ location.search.slice(1) : '';
  // –ø–æ–±–µ–¥–∏—Ç–µ–ª—å (–ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ ‚Äî –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∫–∞–∫ –æ–±—ä—è–≤–ª–µ–Ω—ã –≤ PLANS)
  let bestKey = Object.keys(PLANS)[0], bestVal = -1;
  for(const k of Object.keys(PLANS)){ const v=scores[k]||0; if(v>bestVal){bestVal=v; bestKey=k;} }
  const plan = PLANS[bestKey];

  app.innerHTML = `
    <div class="header">
      <div class="brand">
        <div class="logo">üèÉ‚Äç‚ôÄÔ∏è</div>
        <div class="title"><b>–®–ê–ì–ê–ô –î–û–ú–ê</b><span>–ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è</span></div>
      </div>
      <h1>–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–æ—Ç–æ–≤!</h1>
    </div>
    <div class="result">
      <div class="badge"><b>${plan.icon||'‚≠ê'}</b></div>
      <div class="plan">–í–∞–º –ø–æ–¥—Ö–æ–¥–∏—Ç: <b>${plan.title}</b></div>
      <p class="desc">${plan.desc}</p>
      <a class="buy" href="${plan.buy}${search ? search : ''}" target="_blank" rel="noopener">–ö—É–ø–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É</a>
      <a class="alt" href="#" onclick="location.reload();return false;">–ü—Ä–æ–π—Ç–∏ –µ—â—ë —Ä–∞–∑</a>
      <div class="note">UTM-–º–µ—Ç–∫–∏ –∏–∑ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤—è—Ç—Å—è –∫ —Å—Å—ã–ª–∫–µ –ø–æ–∫—É–ø–∫–∏.</div>
    </div>`;
}

/* —Å—Ç–∞—Ä—Ç */
render();
</script>
</body>
</html>
