<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–ü–æ–¥–±–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã</title>
<style>
:root{
  --bg:#ffffff; --paper:#ffffff; --ink:#1f2328; --muted:#6b7280;
  --line:#eaeaea; --accent:#b22222; --accentGrad1:#ff6d6d; --accentGrad2:#ffb86b;
  --rad:18px; --navH:96px;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--ink);
  font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",Arial,sans-serif;
  background:radial-gradient(1200px 600px at 15% -10%, #fff6e8 0%, #fffaf3 40%, #fff 70%) fixed;
}

/* card */
.wrap{min-height:100%;display:flex;align-items:center;justify-content:center;padding:18px}
.card{
  width:min(980px,100%);
  background:var(--paper);
  border:1px solid var(--line);
  border-radius:var(--rad);
  box-shadow:0 30px 80px rgba(0,0,0,.06);
  overflow:hidden;
}

/* header */
.header{padding:18px;display:flex;gap:12px;align-items:center;justify-content:space-between}
.brand{display:flex;align-items:center;gap:12px}
.brand-img{height:40px;width:auto;display:block}
h1{margin:0;font-size:26px;line-height:1.15}

/* progress */
.progress{padding:0 18px 14px}
.bar{height:10px;border-radius:999px;background:#f0f2f5;position:relative;overflow:hidden;border:1px solid #ececec}
.fill{position:absolute;inset:0 100% 0 0;border-radius:999px;
  background:linear-gradient(90deg,var(--accentGrad1),var(--accentGrad2));transition:inset .35s ease}
.pct{margin-top:6px;font-size:12px;color:var(--muted)}

/* stage & steps */
.stage{position:relative;padding:16px 18px calc(var(--navH) + 16px);min-height:56vh}
.step{position:absolute;inset:0;opacity:0;transform:translateY(8px);transition:.3s}
.step.active{opacity:1;transform:none}
.step.out{opacity:0;transform:translateY(-8px)}
/* –ø—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º–∞—è –∑–æ–Ω–∞ —Å –æ—Ç–≤–µ—Ç–∞–º–∏/–ø–æ–ª—è–º–∏ */
.scroll{max-height:clamp(340px,56svh,640px);overflow:auto;padding-right:6px;scrollbar-width:thin}
@supports not (height:1svh){ .scroll{max-height:clamp(340px,56vh,640px);} }

.q{font-size:26px;line-height:1.15;margin:2px 0 12px}
.sub{color:var(--muted);font-size:14px;margin:0 0 14px}
.illustration{
  display:block;width:100%;max-height:240px;object-fit:contain;margin:0 0 12px;border-radius:14px;
  background:#fff;border:1px solid var(--line)
}

/* options */
.grid{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(230px,1fr))}
.opt{
  display:flex;gap:10px;align-items:center;padding:14px;border:2px dashed #1f4a7f55;border-radius:14px;
  background:#fffdf8;cursor:pointer;transition:.18s;
}
.opt:hover{border-color:#1f4a7f88;background:#fff8ef}
.opt.sel{border-style:solid;border-color:var(--accent);background:#fff1f1}
.opt .ico{font-size:20px;width:26px;text-align:center}
.opt .t{font-size:16px}

/* inputs */
.inputs{display:grid;gap:12px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
.input{background:#fff;border:1px solid var(--line);border-radius:12px;padding:12px;display:flex;flex-direction:column}
.input label{font-size:12px;color:var(--muted);margin-bottom:6px}
.input input{background:transparent;border:0;color:var(--ink);font-size:18px;outline:none}

/* nav */
.nav{
  position:sticky;bottom:0;display:flex;gap:12px;justify-content:space-between;align-items:center;
  padding:12px 18px;background:linear-gradient(180deg,rgba(255,255,255,0),#fff 35%,#fff 60%);
  border-top:1px solid var(--line)
}
.btn{border:0;border-radius:12px;padding:12px 18px;font-weight:800;cursor:pointer}
.btn.secondary{background:#f3f4f6;color:#111827;border:1px solid #e5e7eb}
.btn.primary{background:linear-gradient(90deg,var(--accentGrad1),var(--accentGrad2));color:#1a0b0b}
.btn:disabled{opacity:.55;cursor:not-allowed}

/* loading */
.center{display:grid;place-content:center;text-align:center;height:100%}
.spinner{width:46px;height:46px;border:4px solid #e9ecf1;border-top-color:#ff8a6b;border-radius:50%;margin:8px auto 12px;animation:spin 1s linear infinite}
@keyframes spin{to{transform:rotate(360deg)}}

/* result */
.result{padding:22px 18px 26px;text-align:center}
.badge{
  width:170px;height:170px;margin:8px auto 10px;border-radius:50%;
  background:radial-gradient(circle at 50% 40%,#ffe6ea,#ff98ac 60%,#ff617d);
  box-shadow:0 18px 40px rgba(255,77,94,.25); color:#fff;display:grid;place-content:center;font-size:64px
}
.plan{font-size:24px;margin:6px 0 8px;color:var(--accent)}
.desc{max-width:720px;margin:0 auto 12px;line-height:1.55}
.buy{display:inline-block;margin-top:10px;padding:14px 24px;border-radius:999px;
  background:linear-gradient(90deg,var(--accentGrad1),var(--accentGrad2));color:#1a0b0b;text-decoration:none;font-weight:900}
.alt{display:block;margin-top:10px;color:#374151;text-decoration:underline}
.note{font-size:12px;color:#6b7280;margin-top:8px}

@media (max-width:420px){
  h1{font-size:22px}
  .q{font-size:22px}
}
</style>
</head>
<body>
<div class="wrap">
  <div class="card" id="app">
    <div class="header">
      <div class="brand">
        <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="brand-img"/>
      </div>
      <h1>–ù–∞–π–¥—ë–º –∏–¥–µ–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</h1>
    </div>

    <div class="progress">
      <div class="bar"><div class="fill" id="fill"></div></div>
      <div class="pct" id="pct">0%</div>
    </div>

    <div class="stage" id="stage"></div>

    <div class="nav">
      <button class="btn secondary" id="back">–ù–∞–∑–∞–¥</button>
      <button class="btn primary" id="next" disabled>–î–∞–ª–µ–µ</button>
    </div>
  </div>
</div>

<script>
/* ===== –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ===== */
const ASK_EMAIL = false;

const PLANS = {
  start45:{title:"–ö–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π —Å—Ç–∞—Ä—Ç 45+",icon:"ü´∂",
    desc:"–©–∞–¥—è—â–∏–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏ –±–µ–∑ –ø—Ä—ã–∂–∫–æ–≤, –º—è–≥–∫–æ–µ –∂–∏—Ä–æ—Å–∂–∏–≥–∞–Ω–∏–µ, –∑–∞–±–æ—Ç–∞ –æ —Å—É—Å—Ç–∞–≤–∞—Ö.",
    buy:"https://walk-walk.ru/checkout?plan=start45"},
  fatburn:{title:"–ñ–∏—Ä–æ—Å–∂–∏–≥–∞–Ω–∏–µ Light",icon:"üî•",
    desc:"–®–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ –∏ —Ç–∞–Ω—Ü–µ–≤–∞–ª—å–Ω—ã–µ –∫–∞—Ä–¥–∏–æ-—Å–≤—è–∑–∫–∏ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è –≤–µ—Å–∞ –≤ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ–º —Ç–µ–º–ø–µ.",
    buy:"https://walk-walk.ru/checkout?plan=fatburn"},
  tone:{title:"–¢–æ–Ω—É—Å –∏ –æ—Å–∞–Ω–∫–∞",icon:"üéØ",
    desc:"–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–æ–º–ø–ª–µ–∫—Å—ã –Ω–∞ —Å–ø–∏–Ω—É –∏ –∫–æ—Ä–ø—É—Å: –ø–æ–¥—Ç—è–Ω—É—Ç–∞—è –æ—Å–∞–Ω–∫–∞ –∏ –∫—Ä–µ–ø–∫–∏–π —Ü–µ–Ω—Ç—Ä.",
    buy:"https://walk-walk.ru/checkout?plan=tone"},
  party:{title:"–®–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∏—Å–∫–æ—Ç–µ–∫–∏",icon:"üéµ",
    desc:"–ú—É–∑—ã–∫–∞, –ø—Ä–æ—Å—Ç—ã–µ —Ä–∏—Ç–º—ã, –º–Ω–æ–≥–æ —à–∞–≥–æ–≤ ‚Äî —Ö—É–¥–µ–µ–º ¬´–Ω–∞ —Ä–∞–¥–æ—Å—Ç—è—Ö¬ª.",
    buy:"https://walk-walk.ru/checkout?plan=party"},
  mobility:{title:"–ü–æ–¥–≤–∏–∂–Ω–æ—Å—Ç—å –∏ —Ä–∞—Å—Ç—è–∂–∫–∞",icon:"üßò‚Äç‚ôÄÔ∏è",
    desc:"–ì–∏–±–∫–æ—Å—Ç—å, —Å—É—Å—Ç–∞–≤–Ω–∞—è –º–æ–±–∏–ª–∏–∑–∞—Ü–∏—è –∏ —Ä–∞—Å—Å–ª–∞–±–ª–µ–Ω–∏–µ ‚Äî –æ—Ç–ª–∏—á–Ω–æ–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ –ª—é–±–æ–º—É –ø–ª–∞–Ω—É.",
    buy:"https://walk-walk.ru/checkout?plan=mobility"},
  fast20:{title:"–ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç 20‚Äì25 –º–∏–Ω—É—Ç",icon:"‚è±Ô∏è",
    desc:"–ö–æ—Ä–æ—Ç–∫–∏–µ, –Ω–æ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è, –∫–æ–≥–¥–∞ –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ –¥–ª–∏–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏.",
    buy:"https://walk-walk.ru/checkout?plan=fast20"}
};

/* ===== —à–∞–≥–∏ ===== */
const STEPS = [
  {type:"choice", q:"–í–∞—à –≤–æ–∑—Ä–∞—Å—Ç",
    image:"age.png",
    options:[
      {t:"18‚Äì29 –ª–µ—Ç", plan:null, ico:"‚ú®"},
      {t:"30‚Äì39 –ª–µ—Ç", plan:null, ico:"üåø"},
      {t:"40‚Äì49 –ª–µ—Ç", plan:null, ico:"üå∏"},
      {t:"50+ –ª–µ—Ç",   plan:null, ico:"üí´"}
    ]
  },
  {type:"choice", q:"–ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å –Ω–∞ 4 –Ω–µ–¥–µ–ª–∏:", options:[
    {t:"–ü–æ—Ö—É–¥–µ—Ç—å –∫–æ–º—Ñ–æ—Ä—Ç–Ω–æ", plan:"fatburn", ico:"üî•"},
    {t:"–ù–∞—á–∞—Ç—å –º—è–≥–∫–æ (45+)", plan:"start45", ico:"ü´∂"},
    {t:"–ü–æ–¥—Ç—è–Ω—É—Ç—å –∫–æ—Ä–ø—É—Å/–æ—Å–∞–Ω–∫—É", plan:"tone", ico:"üéØ"},
    {t:"–î–≤–∏–∂–µ–Ω–∏–µ –ø–æ–¥ –º—É–∑—ã–∫—É", plan:"party", ico:"üéµ"},
    {t:"–ì–∏–±–∫–æ—Å—Ç—å –∏ –ª—ë–≥–∫–æ—Å—Ç—å", plan:"mobility", ico:"üßò‚Äç‚ôÄÔ∏è"},
    {t:"–ö–æ—Ä–æ—Ç–∫–∏–µ –∑–∞–Ω—è—Ç–∏—è 20‚Äì25 –º–∏–Ω", plan:"fast20", ico:"‚è±Ô∏è"}
  ]},
  {type:"choice", q:"–¢–µ–∫—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:", options:[
    {t:"–ù–æ–≤–∏—á–æ–∫ / –ø–µ—Ä–µ—Ä—ã–≤", plan:"start45", ico:"üå±"},
    {t:"–†–µ–¥–∫–æ –¥–≤–∏–≥–∞—é—Å—å", plan:"fast20", ico:"‚åõ"},
    {t:"–°—Ä–µ–¥–Ω–∏–π", plan:"fatburn", ico:"üôÇ"},
    {t:"–•–æ—Ä–æ—à–∏–π, –Ω–æ –±–µ–∑ –ø—Ä—ã–∂–∫–æ–≤", plan:"party", ico:"üé∂"},
    {t:"–ù—É–∂–µ–Ω –∞–∫—Ü–µ–Ω—Ç –Ω–∞ —Å–ø–∏–Ω—É/–∫–æ—Ä–ø—É—Å", plan:"tone", ico:"üéØ"}
  ]},
  {type:"inputs", q:"–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–≥–æ –ø–æ–¥–±–æ—Ä–∞",
    sub:"–†–æ—Å—Ç –∏ –≤–µ—Å –ø–æ–º–æ–≥—É—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–µ–µ –ø–æ–¥–æ–±—Ä–∞—Ç—å —Ç–µ–º–ø. (–ú–æ–∂–Ω–æ –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω–æ)",
    fields:[
      {id:"height",label:"–†–æ—Å—Ç (—Å–º)",min:130,max:220,placeholder:"165"},
      {id:"weight",label:"–í–µ—Å (–∫–≥)",min:35,max:180,placeholder:"70"}
    ]
  },
  {type:"choice", q:"–ï—Å—Ç—å –ª–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è?", options:[
    {t:"–ö–æ–ª–µ–Ω–∏/—Å—É—Å—Ç–∞–≤—ã, –Ω—É–∂–Ω–∞ —â–∞–¥—è—â–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞", plan:"start45", ico:"ü¶µ"},
    {t:"–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–∞—è —Å–ø–∏–Ω–∞/—à–µ—è", plan:"tone", ico:"üßç‚Äç‚ôÄÔ∏è"},
    {t:"–ù–µ—Ç —Å–µ—Ä—å—ë–∑–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π", plan:"fatburn", ico:"üí™"},
    {t:"–ü—Ä–µ–¥–ø–æ—á–∏—Ç–∞—é –Ω–∏–∑–∫—É—é —É–¥–∞—Ä–Ω—É—é –Ω–∞–≥—Ä—É–∑–∫—É", plan:"mobility", ico:"üßò‚Äç‚ôÄÔ∏è"}
  ]},
  {type:"choice", q:"–ö–∞–∫–∏–µ —Ñ–æ—Ä–º–∞—Ç—ã –Ω—Ä–∞–≤—è—Ç—Å—è –±–æ–ª—å—à–µ?", options:[
    {t:"–®–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ/—Ç–∞–Ω—Ü–µ–≤–∞–ª—å–Ω—ã–µ", plan:"party", ico:"üéµ"},
    {t:"–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –Ω–∞ –∫–æ—Ä–ø—É—Å", plan:"tone", ico:"üéØ"},
    {t:"–ö–∞—Ä–¥–∏–æ + –Ω–µ–º–Ω–æ–≥–æ —Å–∏–ª–æ–≤—ã—Ö", plan:"fatburn", ico:"üî•"},
    {t:"–†–∞—Å—Ç—è–∂–∫–∞ –∏ –¥—ã—Ö–∞–Ω–∏–µ", plan:"mobility", ico:"üßò‚Äç‚ôÄÔ∏è"},
    {t:"–ö–æ—Ä–æ—Ç–∫–∏–µ —ç–∫—Å–ø—Ä–µ—Å—Å-–∑–∞–Ω—è—Ç–∏—è", plan:"fast20", ico:"‚è±Ô∏è"},
    {t:"–ú—è–≥–∫–æ 45+", plan:"start45", ico:"ü´∂"}
  ]},
  {type:"choice", q:"–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å:", options:[
    {t:"–ë–µ–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è", plan:"party", ico:"üö´"},
    {t:"–¢–æ–ª—å–∫–æ –∫–æ–≤—Ä–∏–∫", plan:"mobility", ico:"üßò"},
    {t:"–†–µ–∑–∏–Ω–∫–∏/–≥–∞–Ω—Ç–µ–ª–∏ light", plan:"fatburn", ico:"üèãÔ∏è"},
    {t:"–ú—è—á/—Ä–æ–ª–ª/–ª–µ–Ω—Ç–∞", plan:"tone", ico:"üß∂"}
  ]},
  {type:"choice", q:"–¢–µ–º–ø –∑–∞–Ω—è—Ç–∏–π:", options:[
    {t:"–°–ø–æ–∫–æ–π–Ω—ã–π", plan:"mobility", ico:"ü´ß"},
    {t:"–ú—è–≥–∫–∏–π, –±–µ–∑ –ø—Ä—ã–∂–∫–æ–≤", plan:"start45", ico:"ü´∂"},
    {t:"–°—Ä–µ–¥–Ω–∏–π, –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π", plan:"fatburn", ico:"üôÇ"},
    {t:"–≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π, –Ω–æ –±–µ–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏", plan:"party", ico:"üé∂"},
    {t:"–° –∞–∫—Ü–µ–Ω—Ç–æ–º –Ω–∞ —Ç–µ—Ö–Ω–∏–∫—É", plan:"tone", ico:"üéØ"}
  ]},
  {type:"email", q:"–ö—É–¥–∞ –ø—Ä–∏—Å–ª–∞—Ç—å –ø–ª–∞–Ω –∏ –ø–µ—Ä–≤—É—é —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫—É?",
    sub:"–ú—ã –Ω–µ –ø–∏—à–µ–º –ª–∏—à–Ω–µ–≥–æ –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞—ë–º –∞–¥—Ä–µ—Å —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º."
  },
  {type:"loading"}
];

/* ===== —Å–æ—Å—Ç–æ—è–Ω–∏–µ ===== */
let step = 0;
const scores = {};
const data   = {};
const stage  = document.getElementById('stage');
const fill   = document.getElementById('fill');
const pct    = document.getElementById('pct');
const nextBt = document.getElementById('next');
const backBt = document.getElementById('back');

/* ===== —É—Ç–∏–ª–∏—Ç—ã ===== */
const qs = (s,el=document)=>el.querySelector(s);
function setProgress(){
  const total = STEPS.length;
  const p = Math.round((Math.min(step, total-1))/(total-1)*100);
  fill.style.insetInlineEnd = (100-p)+'%';
  pct.textContent = p + '%';
}
function bump(plan, n=1){ if(!plan) return; scores[plan]=(scores[plan]||0)+n; }
function bmiScore(h, w){
  if(!h||!w) return;
  const m = w / Math.pow(h/100,2);
  if(m >= 27) bump('fatburn',2);
  else if(m >= 24) bump('fatburn',1);
  if(m < 22) bump('tone',1);
}

/* ===== —Ä–µ–Ω–¥–µ—Ä —à–∞–≥–∞ ===== */
function render(){
  setProgress();
  const prev = qs('.step.active', stage);
  if(prev){ prev.classList.remove('active'); prev.classList.add('out'); setTimeout(()=>prev.remove(),280); }

  const cfg = STEPS[step];
  const el  = document.createElement('div');
  el.className = 'step';
  stage.appendChild(el);

  nextBt.disabled = true;
  backBt.disabled = (step===0);

  if(cfg.type==='choice'){
    el.innerHTML = `
      ${cfg.image?`<img class="illustration" src="${cfg.image}" alt="–ò–ª–ª—é—Å—Ç—Ä–∞—Ü–∏—è –∫ –≤–æ–ø—Ä–æ—Å—É">`:''}
      <div class="q">${cfg.q}</div>
      ${cfg.sub?`<div class="sub">${cfg.sub}</div>`:''}
      <div class="scroll">
        <div class="grid">
          ${cfg.options.map(o=>`
            <button class="opt" data-plan="${o.plan||''}">
              <div class="ico">${o.ico||'‚Ä¢'}</div><div class="t">${o.t}</div>
            </button>`).join('')}
        </div>
      </div>`;
    el.addEventListener('click',(e)=>{
      const btn = e.target.closest('.opt'); if(!btn) return;
      el.querySelectorAll('.opt').forEach(b=>b.classList.remove('sel'));
      btn.classList.add('sel'); nextBt.disabled=false;
      data['step'+step] = btn.textContent.trim();
      const p = btn.dataset.plan || null;
      if(p) bump(p,1);
      btn.scrollIntoView({block:'nearest',behavior:'smooth'});
    });
  }

  if(cfg.type==='inputs'){
    el.innerHTML = `
      <div class="q">${cfg.q}</div>
      ${cfg.sub?`<div class="sub">${cfg.sub}</div>`:''}
      <div class="scroll">
        <div class="inputs">
          ${cfg.fields.map(f=>`
            <div class="input">
              <label for="${f.id}">${f.label}</label>
              <input id="${f.id}" type="number" inputmode="decimal"
                placeholder="${f.placeholder||''}" min="${f.min||''}" max="${f.max||''}"/>
            </div>`).join('')}
        </div>
      </div>`;
    const h=qs('#height',el), w=qs('#weight',el);
    const validate = ()=>{
      const hv = Number(h?.value||h?.placeholder||0);
      const wv = Number(w?.value||w?.placeholder||0);
      nextBt.disabled = !(hv>=130 && hv<=220 && wv>=35 && wv<=180);
      if(!nextBt.disabled){ data.height=hv; data.weight=wv; }
    };
    el.addEventListener('input', validate);
    validate();
  }

  if(cfg.type==='email'){
    if(!ASK_EMAIL){ step++; render(); return; }
    el.innerHTML = `
      <div class="q">${cfg.q}</div>
      ${cfg.sub?`<div class="sub">${cfg.sub}</div>`:''}
      <div class="scroll" style="max-height:260px">
        <div class="inputs" style="max-width:520px">
          <div class="input" style="grid-column:1/-1">
            <label for="email">–í–∞—à e-mail</label>
            <input id="email" type="email" placeholder="name@example.com"/>
          </div>
        </div>
      </div>`;
    const em=qs('#email',el);
    const validate = ()=>{
      const ok = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(em.value);
      nextBt.disabled=!ok; if(ok) data.email=em.value;
    };
    el.addEventListener('input', validate);
    validate();
  }

  if(cfg.type==='loading'){
    el.innerHTML = `
      <div class="center">
        <div class="spinner"></div>
        <div class="sub">–ê–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç—ã‚Ä¶</div>
      </div>`;
    nextBt.disabled = true; backBt.disabled = true;
    if(data.height && data.weight) bmiScore(data.height, data.weight);
    setTimeout(showResult, 1300);
  }

  requestAnimationFrame(()=>el.classList.add('active'));
}

/* ===== —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ ===== */
document.getElementById('next').addEventListener('click',()=>{
  step = Math.min(step+1, STEPS.length-1);
  render();
});
document.getElementById('back').addEventListener('click',()=>{
  if(step===0) return;
  step--; render();
});

/* ===== —Ä–µ–∑—É–ª—å—Ç–∞—Ç ===== */
function showResult(){
  const app = document.getElementById('app');
  const search = location.search ? '&'+ location.search.slice(1) : '';
  let bestKey = Object.keys(PLANS)[0], bestVal = -1;
  for(const k of Object.keys(PLANS)){ const v=scores[k]||0; if(v>bestVal){bestVal=v; bestKey=k;} }
  const plan = PLANS[bestKey];

  app.innerHTML = `
    <div class="header">
      <div class="brand">
        <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="brand-img"/>
      </div>
      <h1>–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–æ—Ç–æ–≤!</h1>
    </div>
    <div class="result">
      <div class="badge">${plan.icon||'‚≠ê'}</div>
      <div class="plan">–í–∞–º –ø–æ–¥—Ö–æ–¥–∏—Ç: <b>${plan.title}</b></div>
      <p class="desc">${plan.desc}</p>
      <a class="buy" href="${plan.buy}${search ? search : ''}" target="_blank" rel="noopener">–ö—É–ø–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É</a>
      <a class="alt" href="#" onclick="location.reload();return false;">–ü—Ä–æ–π—Ç–∏ –µ—â—ë —Ä–∞–∑</a>
      <div class="note">UTM-–º–µ—Ç–∫–∏ –∏–∑ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤—è—Ç—Å—è –∫ —Å—Å—ã–ª–∫–µ –ø–æ–∫—É–ø–∫–∏.</div>
    </div>`;
}

/* —Å—Ç–∞—Ä—Ç */
render();
</script>
</body>
  </html>
